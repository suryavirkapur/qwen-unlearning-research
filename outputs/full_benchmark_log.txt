`torch_dtype` is deprecated! Use `dtype` instead!
============================================================
Setting up benchmark environment...
============================================================

[1/3] Loading model...
Loading model: Qwen/Qwen3-4B-Instruct-2507
Quantization: True, LoRA: True
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:01<00:02,  1.04s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:02<00:01,  1.14s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:02<00:00,  1.32it/s]
trainable params: 11,796,480 || all params: 4,034,264,576 || trainable%: 0.2924
  Trainable params: 11,796,480 / 2,217,606,656 (0.53%)

[2/3] Loading TOFU dataset...
  Loading forget config: forget01
  Loading retain config: retain99
  Forget samples: 40, Retain samples: 3960
  Forget samples: 40
  Retain samples: 3960

[3/3] Computing baseline perplexities...
Computing perplexity:   0%|          | 0/40 [00:00<?, ?it/s]Computing perplexity:   2%|▎         | 1/40 [00:00<00:13,  2.91it/s]Computing perplexity:   5%|▌         | 2/40 [00:00<00:09,  4.00it/s]Computing perplexity:   8%|▊         | 3/40 [00:00<00:08,  4.54it/s]Computing perplexity:  10%|█         | 4/40 [00:00<00:07,  4.82it/s]Computing perplexity:  12%|█▎        | 5/40 [00:01<00:07,  4.98it/s]Computing perplexity:  15%|█▌        | 6/40 [00:01<00:06,  5.10it/s]Computing perplexity:  18%|█▊        | 7/40 [00:01<00:06,  5.17it/s]Computing perplexity:  20%|██        | 8/40 [00:01<00:06,  5.24it/s]Computing perplexity:  22%|██▎       | 9/40 [00:01<00:05,  5.28it/s]Computing perplexity:  25%|██▌       | 10/40 [00:02<00:05,  5.29it/s]Computing perplexity:  28%|██▊       | 11/40 [00:02<00:05,  5.32it/s]Computing perplexity:  30%|███       | 12/40 [00:02<00:05,  5.34it/s]Computing perplexity:  32%|███▎      | 13/40 [00:02<00:05,  5.33it/s]Computing perplexity:  35%|███▌      | 14/40 [00:02<00:04,  5.35it/s]Computing perplexity:  38%|███▊      | 15/40 [00:02<00:04,  5.36it/s]Computing perplexity:  40%|████      | 16/40 [00:03<00:04,  5.34it/s]Computing perplexity:  42%|████▎     | 17/40 [00:03<00:04,  5.35it/s]Computing perplexity:  45%|████▌     | 18/40 [00:03<00:04,  5.36it/s]Computing perplexity:  48%|████▊     | 19/40 [00:03<00:03,  5.34it/s]Computing perplexity:  50%|█████     | 20/40 [00:03<00:03,  5.37it/s]Computing perplexity:  52%|█████▎    | 21/40 [00:04<00:03,  5.37it/s]Computing perplexity:  55%|█████▌    | 22/40 [00:04<00:03,  5.35it/s]Computing perplexity:  57%|█████▊    | 23/40 [00:04<00:03,  5.36it/s]Computing perplexity:  60%|██████    | 24/40 [00:04<00:02,  5.36it/s]Computing perplexity:  62%|██████▎   | 25/40 [00:04<00:02,  5.34it/s]Computing perplexity:  65%|██████▌   | 26/40 [00:05<00:02,  5.35it/s]Computing perplexity:  68%|██████▊   | 27/40 [00:05<00:02,  5.34it/s]Computing perplexity:  70%|███████   | 28/40 [00:05<00:02,  5.34it/s]Computing perplexity:  72%|███████▎  | 29/40 [00:05<00:02,  5.36it/s]Computing perplexity:  75%|███████▌  | 30/40 [00:05<00:01,  5.35it/s]Computing perplexity:  78%|███████▊  | 31/40 [00:06<00:01,  4.57it/s]Computing perplexity:  80%|████████  | 32/40 [00:06<00:01,  4.77it/s]Computing perplexity:  82%|████████▎ | 33/40 [00:06<00:01,  4.93it/s]Computing perplexity:  85%|████████▌ | 34/40 [00:06<00:01,  5.06it/s]Computing perplexity:  88%|████████▊ | 35/40 [00:06<00:00,  5.13it/s]Computing perplexity:  90%|█████████ | 36/40 [00:06<00:00,  5.20it/s]Computing perplexity:  92%|█████████▎| 37/40 [00:07<00:00,  5.26it/s]Computing perplexity:  95%|█████████▌| 38/40 [00:07<00:00,  5.27it/s]Computing perplexity:  98%|█████████▊| 39/40 [00:07<00:00,  5.30it/s]Computing perplexity: 100%|██████████| 40/40 [00:07<00:00,  5.32it/s]                                                                     Computing perplexity:   0%|          | 0/3960 [00:00<?, ?it/s]Computing perplexity:   0%|          | 1/3960 [00:00<12:24,  5.32it/s]Computing perplexity:   0%|          | 2/3960 [00:00<12:18,  5.36it/s]Computing perplexity:   0%|          | 3/3960 [00:00<12:19,  5.35it/s]Computing perplexity:   0%|          | 4/3960 [00:00<12:19,  5.35it/s]Computing perplexity:   0%|          | 5/3960 [00:00<12:17,  5.36it/s]Computing perplexity:   0%|          | 6/3960 [00:01<12:20,  5.34it/s]Computing perplexity:   0%|          | 7/3960 [00:01<12:22,  5.33it/s]Computing perplexity:   0%|          | 8/3960 [00:01<12:19,  5.34it/s]Computing perplexity:   0%|          | 9/3960 [00:01<12:22,  5.32it/s]Computing perplexity:   0%|          | 10/3960 [00:01<12:19,  5.34it/s]Computing perplexity:   0%|          | 11/3960 [00:02<12:18,  5.34it/s]Computing perplexity:   0%|          | 12/3960 [00:02<12:20,  5.33it/s]Computing perplexity:   0%|          | 13/3960 [00:02<12:17,  5.35it/s]Computing perplexity:   0%|          | 14/3960 [00:02<12:17,  5.35it/s]Computing perplexity:   0%|          | 15/3960 [00:02<12:18,  5.34it/s]Computing perplexity:   0%|          | 16/3960 [00:02<12:17,  5.35it/s]Computing perplexity:   0%|          | 17/3960 [00:03<12:18,  5.34it/s]Computing perplexity:   0%|          | 18/3960 [00:03<12:18,  5.34it/s]Computing perplexity:   0%|          | 19/3960 [00:03<12:15,  5.36it/s]Computing perplexity:   1%|          | 20/3960 [00:03<12:17,  5.34it/s]Computing perplexity:   1%|          | 21/3960 [00:03<12:16,  5.35it/s]Computing perplexity:   1%|          | 22/3960 [00:04<12:16,  5.35it/s]Computing perplexity:   1%|          | 23/3960 [00:04<12:18,  5.33it/s]Computing perplexity:   1%|          | 24/3960 [00:04<12:15,  5.35it/s]Computing perplexity:   1%|          | 25/3960 [00:04<12:16,  5.34it/s]Computing perplexity:   1%|          | 26/3960 [00:04<12:17,  5.33it/s]Computing perplexity:   1%|          | 27/3960 [00:05<12:15,  5.35it/s]Computing perplexity:   1%|          | 28/3960 [00:05<12:17,  5.33it/s]Computing perplexity:   1%|          | 29/3960 [00:05<12:17,  5.33it/s]Computing perplexity:   1%|          | 30/3960 [00:05<12:16,  5.34it/s]Computing perplexity:   1%|          | 31/3960 [00:05<12:19,  5.31it/s]Computing perplexity:   1%|          | 32/3960 [00:05<12:17,  5.32it/s]Computing perplexity:   1%|          | 33/3960 [00:06<12:18,  5.32it/s]Computing perplexity:   1%|          | 34/3960 [00:06<12:17,  5.33it/s]Computing perplexity:   1%|          | 35/3960 [00:06<12:15,  5.33it/s]Computing perplexity:   1%|          | 36/3960 [00:06<12:17,  5.32it/s]Computing perplexity:   1%|          | 37/3960 [00:06<12:14,  5.34it/s]Computing perplexity:   1%|          | 38/3960 [00:07<12:16,  5.32it/s]Computing perplexity:   1%|          | 39/3960 [00:07<12:16,  5.32it/s]Computing perplexity:   1%|          | 40/3960 [00:07<12:15,  5.33it/s]Computing perplexity:   1%|          | 41/3960 [00:07<12:18,  5.30it/s]Computing perplexity:   1%|          | 42/3960 [00:07<12:15,  5.33it/s]Computing perplexity:   1%|          | 43/3960 [00:08<12:16,  5.32it/s]Computing perplexity:   1%|          | 44/3960 [00:08<12:16,  5.32it/s]Computing perplexity:   1%|          | 45/3960 [00:08<12:14,  5.33it/s]Computing perplexity:   1%|          | 46/3960 [00:08<12:16,  5.31it/s]Computing perplexity:   1%|          | 47/3960 [00:08<12:14,  5.33it/s]Computing perplexity:   1%|          | 48/3960 [00:08<12:15,  5.32it/s]Computing perplexity:   1%|          | 49/3960 [00:09<12:13,  5.33it/s]                                                                         Baseline forget PPL: 218817104.00
  Baseline retain PPL: 240675872.00

Setup complete!

============================================================
Method: Retraining (Gold Standard)
============================================================
  Using theoretical values (retrain from scratch)

============================================================
Method: Naive Fine-tuning (FT)
============================================================
  Resetting model to fresh state...
Loading model: Qwen/Qwen3-4B-Instruct-2507
Quantization: True, LoRA: True
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:01<00:02,  1.03s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:02<00:01,  1.13s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:02<00:00,  1.33it/s]
trainable params: 11,796,480 || all params: 4,034,264,576 || trainable%: 0.2924
Epoch 1/3:   0%|          | 0/3960 [00:00<?, ?it/s]Epoch 1/3:   0%|          | 1/3960 [00:00<41:34,  1.59it/s]Epoch 1/3:   0%|          | 2/3960 [00:01<41:15,  1.60it/s]Epoch 1/3:   0%|          | 3/3960 [00:01<41:11,  1.60it/s]Epoch 1/3:   0%|          | 4/3960 [00:02<41:20,  1.60it/s]Epoch 1/3:   0%|          | 5/3960 [00:03<41:13,  1.60it/s]Epoch 1/3:   0%|          | 6/3960 [00:03<41:09,  1.60it/s]Epoch 1/3:   0%|          | 7/3960 [00:04<41:06,  1.60it/s]Epoch 1/3:   0%|          | 8/3960 [00:04<41:05,  1.60it/s]Epoch 1/3:   0%|          | 9/3960 [00:05<41:05,  1.60it/s]Epoch 1/3:   0%|          | 9/3960 [00:06<41:05,  1.60it/s, loss=13]Epoch 1/3:   0%|          | 10/3960 [00:06<41:03,  1.60it/s, loss=13]Epoch 1/3:   0%|          | 11/3960 [00:06<41:00,  1.60it/s, loss=13]Epoch 1/3:   0%|          | 12/3960 [00:07<41:01,  1.60it/s, loss=13]Epoch 1/3:   0%|          | 13/3960 [00:08<40:59,  1.60it/s, loss=13]Epoch 1/3:   0%|          | 14/3960 [00:08<40:57,  1.61it/s, loss=13]Epoch 1/3:   0%|          | 15/3960 [00:09<40:59,  1.60it/s, loss=13]Epoch 1/3:   0%|          | 16/3960 [00:09<40:59,  1.60it/s, loss=13]Epoch 1/3:   0%|          | 17/3960 [00:10<40:58,  1.60it/s, loss=13]Epoch 1/3:   0%|          | 18/3960 [00:11<40:56,  1.60it/s, loss=13]Epoch 1/3:   0%|          | 19/3960 [00:11<40:56,  1.60it/s, loss=13]Epoch 1/3:   0%|          | 19/3960 [00:12<40:56,  1.60it/s, loss=12.7]Epoch 1/3:   1%|          | 20/3960 [00:12<40:55,  1.60it/s, loss=12.7]Epoch 1/3:   1%|          | 21/3960 [00:13<40:56,  1.60it/s, loss=12.7]Epoch 1/3:   1%|          | 22/3960 [00:13<40:55,  1.60it/s, loss=12.7]Epoch 1/3:   1%|          | 23/3960 [00:14<40:53,  1.60it/s, loss=12.7]Epoch 1/3:   1%|          | 24/3960 [00:14<40:54,  1.60it/s, loss=12.7]Epoch 1/3:   1%|          | 25/3960 [00:15<40:53,  1.60it/s, loss=12.7]Epoch 1/3:   1%|          | 26/3960 [00:16<40:54,  1.60it/s, loss=12.7]Epoch 1/3:   1%|          | 27/3960 [00:16<40:52,  1.60it/s, loss=12.7]Epoch 1/3:   1%|          | 28/3960 [00:17<40:49,  1.61it/s, loss=12.7]Epoch 1/3:   1%|          | 29/3960 [00:18<40:49,  1.60it/s, loss=12.7]Epoch 1/3:   1%|          | 29/3960 [00:18<40:49,  1.60it/s, loss=7.8] Epoch 1/3:   1%|          | 30/3960 [00:18<40:47,  1.61it/s, loss=7.8]Epoch 1/3:   1%|          | 31/3960 [00:19<40:47,  1.61it/s, loss=7.8]Epoch 1/3:   1%|          | 32/3960 [00:19<40:50,  1.60it/s, loss=7.8]Epoch 1/3:   1%|          | 33/3960 [00:20<40:50,  1.60it/s, loss=7.8]Epoch 1/3:   1%|          | 34/3960 [00:21<40:49,  1.60it/s, loss=7.8]Epoch 1/3:   1%|          | 35/3960 [00:21<40:46,  1.60it/s, loss=7.8]Epoch 1/3:   1%|          | 36/3960 [00:22<40:48,  1.60it/s, loss=7.8]Epoch 1/3:   1%|          | 37/3960 [00:23<40:51,  1.60it/s, loss=7.8]Epoch 1/3:   1%|          | 38/3960 [00:23<40:49,  1.60it/s, loss=7.8]Epoch 1/3:   1%|          | 39/3960 [00:24<40:44,  1.60it/s, loss=7.8]Epoch 1/3:   1%|          | 39/3960 [00:24<40:44,  1.60it/s, loss=6.83]Epoch 1/3:   1%|          | 40/3960 [00:24<40:43,  1.60it/s, loss=6.83]Epoch 1/3:   1%|          | 41/3960 [00:25<40:41,  1.61it/s, loss=6.83]Epoch 1/3:   1%|          | 42/3960 [00:26<40:44,  1.60it/s, loss=6.83]Epoch 1/3:   1%|          | 43/3960 [00:26<40:41,  1.60it/s, loss=6.83]Epoch 1/3:   1%|          | 44/3960 [00:27<40:39,  1.61it/s, loss=6.83]Epoch 1/3:   1%|          | 45/3960 [00:28<40:40,  1.60it/s, loss=6.83]Epoch 1/3:   1%|          | 46/3960 [00:28<40:41,  1.60it/s, loss=6.83]Epoch 1/3:   1%|          | 47/3960 [00:29<40:41,  1.60it/s, loss=6.83]Epoch 1/3:   1%|          | 48/3960 [00:29<40:40,  1.60it/s, loss=6.83]Epoch 1/3:   1%|          | 49/3960 [00:30<40:38,  1.60it/s, loss=6.83]Epoch 1/3:   1%|          | 49/3960 [00:31<40:38,  1.60it/s, loss=0.712]Epoch 1/3:   1%|▏         | 50/3960 [00:31<40:35,  1.61it/s, loss=0.712]Epoch 1/3:   1%|▏         | 51/3960 [00:31<40:33,  1.61it/s, loss=0.712]Epoch 1/3:   1%|▏         | 52/3960 [00:32<40:32,  1.61it/s, loss=0.712]Epoch 1/3:   1%|▏         | 53/3960 [00:33<40:34,  1.61it/s, loss=0.712]Epoch 1/3:   1%|▏         | 54/3960 [00:33<40:38,  1.60it/s, loss=0.712]Epoch 1/3:   1%|▏         | 55/3960 [00:34<40:38,  1.60it/s, loss=0.712]Epoch 1/3:   1%|▏         | 56/3960 [00:34<40:37,  1.60it/s, loss=0.712]Epoch 1/3:   1%|▏         | 57/3960 [00:35<40:41,  1.60it/s, loss=0.712]Epoch 1/3:   1%|▏         | 58/3960 [00:36<40:40,  1.60it/s, loss=0.712]Epoch 1/3:   1%|▏         | 59/3960 [00:36<40:39,  1.60it/s, loss=0.712]Epoch 1/3:   1%|▏         | 59/3960 [00:37<40:39,  1.60it/s, loss=1.1]  Epoch 1/3:   2%|▏         | 60/3960 [00:37<40:39,  1.60it/s, loss=1.1]Epoch 1/3:   2%|▏         | 61/3960 [00:38<40:39,  1.60it/s, loss=1.1]Epoch 1/3:   2%|▏         | 62/3960 [00:38<40:38,  1.60it/s, loss=1.1]Epoch 1/3:   2%|▏         | 63/3960 [00:39<40:37,  1.60it/s, loss=1.1]Epoch 1/3:   2%|▏         | 64/3960 [00:39<40:40,  1.60it/s, loss=1.1]Epoch 1/3:   2%|▏         | 65/3960 [00:40<40:36,  1.60it/s, loss=1.1]Epoch 1/3:   2%|▏         | 66/3960 [00:41<40:35,  1.60it/s, loss=1.1]Epoch 1/3:   2%|▏         | 67/3960 [00:41<40:37,  1.60it/s, loss=1.1]Epoch 1/3:   2%|▏         | 68/3960 [00:42<40:34,  1.60it/s, loss=1.1]Epoch 1/3:   2%|▏         | 69/3960 [00:43<40:33,  1.60it/s, loss=1.1]Epoch 1/3:   2%|▏         | 69/3960 [00:43<40:33,  1.60it/s, loss=0.436]Epoch 1/3:   2%|▏         | 70/3960 [00:43<40:34,  1.60it/s, loss=0.436]Epoch 1/3:   2%|▏         | 71/3960 [00:44<40:34,  1.60it/s, loss=0.436]Epoch 1/3:   2%|▏         | 72/3960 [00:44<40:32,  1.60it/s, loss=0.436]Epoch 1/3:   2%|▏         | 73/3960 [00:45<40:32,  1.60it/s, loss=0.436]Epoch 1/3:   2%|▏         | 74/3960 [00:46<40:34,  1.60it/s, loss=0.436]Epoch 1/3:   2%|▏         | 75/3960 [00:46<40:32,  1.60it/s, loss=0.436]Epoch 1/3:   2%|▏         | 76/3960 [00:47<40:33,  1.60it/s, loss=0.436]Epoch 1/3:   2%|▏         | 77/3960 [00:48<40:33,  1.60it/s, loss=0.436]Epoch 1/3:   2%|▏         | 78/3960 [00:48<40:29,  1.60it/s, loss=0.436]Epoch 1/3:   2%|▏         | 79/3960 [00:49<40:27,  1.60it/s, loss=0.436]Epoch 1/3:   2%|▏         | 79/3960 [00:49<40:27,  1.60it/s, loss=0.453]Epoch 1/3:   2%|▏         | 80/3960 [00:49<40:30,  1.60it/s, loss=0.453]Epoch 1/3:   2%|▏         | 81/3960 [00:50<40:28,  1.60it/s, loss=0.453]Epoch 1/3:   2%|▏         | 82/3960 [00:51<40:25,  1.60it/s, loss=0.453]Epoch 1/3:   2%|▏         | 83/3960 [00:51<40:24,  1.60it/s, loss=0.453]Epoch 1/3:   2%|▏         | 84/3960 [00:52<40:24,  1.60it/s, loss=0.453]Epoch 1/3:   2%|▏         | 85/3960 [00:53<40:24,  1.60it/s, loss=0.453]Epoch 1/3:   2%|▏         | 86/3960 [00:53<40:23,  1.60it/s, loss=0.453]Epoch 1/3:   2%|▏         | 87/3960 [00:54<40:25,  1.60it/s, loss=0.453]Epoch 1/3:   2%|▏         | 88/3960 [00:54<40:22,  1.60it/s, loss=0.453]Epoch 1/3:   2%|▏         | 89/3960 [00:55<40:19,  1.60it/s, loss=0.453]Epoch 1/3:   2%|▏         | 89/3960 [00:56<40:19,  1.60it/s, loss=0.545]Epoch 1/3:   2%|▏         | 90/3960 [00:56<40:18,  1.60it/s, loss=0.545]Epoch 1/3:   2%|▏         | 91/3960 [00:56<40:20,  1.60it/s, loss=0.545]Epoch 1/3:   2%|▏         | 92/3960 [00:57<40:18,  1.60it/s, loss=0.545]Epoch 1/3:   2%|▏         | 93/3960 [00:58<40:18,  1.60it/s, loss=0.545]Epoch 1/3:   2%|▏         | 94/3960 [00:58<40:20,  1.60it/s, loss=0.545]Epoch 1/3:   2%|▏         | 95/3960 [00:59<40:17,  1.60it/s, loss=0.545]Epoch 1/3:   2%|▏         | 96/3960 [00:59<40:16,  1.60it/s, loss=0.545]Epoch 1/3:   2%|▏         | 97/3960 [01:00<40:17,  1.60it/s, loss=0.545]Epoch 1/3:   2%|▏         | 98/3960 [01:01<40:17,  1.60it/s, loss=0.545]Epoch 1/3:   2%|▎         | 99/3960 [01:01<40:16,  1.60it/s, loss=0.545]Epoch 1/3:   2%|▎         | 99/3960 [01:02<40:16,  1.60it/s, loss=0.425]Epoch 1/3:   2%|▎         | 99/3960 [01:02<40:36,  1.58it/s, loss=0.425]
  Evaluating Naive Fine-tuning (FT)...
Running full evaluation...
  Computing forget efficacy...
Computing perplexity:   0%|          | 0/40 [00:00<?, ?it/s]Computing perplexity:   2%|▎         | 1/40 [00:00<00:07,  5.45it/s]Computing perplexity:   5%|▌         | 2/40 [00:00<00:07,  5.33it/s]Computing perplexity:   8%|▊         | 3/40 [00:00<00:06,  5.32it/s]Computing perplexity:  10%|█         | 4/40 [00:00<00:06,  5.30it/s]Computing perplexity:  12%|█▎        | 5/40 [00:00<00:06,  5.30it/s]Computing perplexity:  15%|█▌        | 6/40 [00:01<00:06,  5.26it/s]Computing perplexity:  18%|█▊        | 7/40 [00:01<00:06,  5.28it/s]Computing perplexity:  20%|██        | 8/40 [00:01<00:06,  5.27it/s]Computing perplexity:  22%|██▎       | 9/40 [00:01<00:05,  5.28it/s]Computing perplexity:  25%|██▌       | 10/40 [00:01<00:05,  5.27it/s]Computing perplexity:  28%|██▊       | 11/40 [00:02<00:05,  5.27it/s]Computing perplexity:  30%|███       | 12/40 [00:02<00:05,  5.26it/s]Computing perplexity:  32%|███▎      | 13/40 [00:02<00:05,  5.27it/s]Computing perplexity:  35%|███▌      | 14/40 [00:02<00:04,  5.26it/s]Computing perplexity:  38%|███▊      | 15/40 [00:02<00:04,  5.27it/s]Computing perplexity:  40%|████      | 16/40 [00:03<00:04,  5.26it/s]Computing perplexity:  42%|████▎     | 17/40 [00:03<00:04,  5.28it/s]Computing perplexity:  45%|████▌     | 18/40 [00:03<00:04,  5.26it/s]Computing perplexity:  48%|████▊     | 19/40 [00:03<00:03,  5.28it/s]Computing perplexity:  50%|█████     | 20/40 [00:03<00:03,  5.26it/s]Computing perplexity:  52%|█████▎    | 21/40 [00:03<00:03,  5.29it/s]Computing perplexity:  55%|█████▌    | 22/40 [00:04<00:03,  5.27it/s]Computing perplexity:  57%|█████▊    | 23/40 [00:04<00:03,  5.29it/s]Computing perplexity:  60%|██████    | 24/40 [00:04<00:03,  5.28it/s]Computing perplexity:  62%|██████▎   | 25/40 [00:04<00:02,  5.29it/s]Computing perplexity:  65%|██████▌   | 26/40 [00:04<00:02,  5.29it/s]Computing perplexity:  68%|██████▊   | 27/40 [00:05<00:02,  5.29it/s]Computing perplexity:  70%|███████   | 28/40 [00:05<00:02,  5.29it/s]Computing perplexity:  72%|███████▎  | 29/40 [00:05<00:02,  5.29it/s]Computing perplexity:  75%|███████▌  | 30/40 [00:05<00:01,  5.29it/s]Computing perplexity:  78%|███████▊  | 31/40 [00:05<00:01,  5.28it/s]Computing perplexity:  80%|████████  | 32/40 [00:06<00:01,  5.30it/s]Computing perplexity:  82%|████████▎ | 33/40 [00:06<00:01,  5.28it/s]Computing perplexity:  85%|████████▌ | 34/40 [00:06<00:01,  5.30it/s]Computing perplexity:  88%|████████▊ | 35/40 [00:06<00:00,  5.29it/s]Computing perplexity:  90%|█████████ | 36/40 [00:06<00:00,  5.29it/s]Computing perplexity:  92%|█████████▎| 37/40 [00:07<00:00,  5.29it/s]Computing perplexity:  95%|█████████▌| 38/40 [00:07<00:00,  5.29it/s]Computing perplexity:  98%|█████████▊| 39/40 [00:07<00:00,  5.29it/s]Computing perplexity: 100%|██████████| 40/40 [00:07<00:00,  5.28it/s]                                                                       Computing retain performance...
Computing perplexity:   0%|          | 0/3960 [00:00<?, ?it/s]Computing perplexity:   0%|          | 1/3960 [00:00<12:20,  5.35it/s]Computing perplexity:   0%|          | 2/3960 [00:00<12:25,  5.31it/s]Computing perplexity:   0%|          | 3/3960 [00:00<12:25,  5.31it/s]Computing perplexity:   0%|          | 4/3960 [00:00<12:28,  5.29it/s]Computing perplexity:   0%|          | 5/3960 [00:00<12:26,  5.30it/s]Computing perplexity:   0%|          | 6/3960 [00:01<12:29,  5.28it/s]Computing perplexity:   0%|          | 7/3960 [00:01<12:27,  5.29it/s]Computing perplexity:   0%|          | 8/3960 [00:01<12:30,  5.27it/s]Computing perplexity:   0%|          | 9/3960 [00:01<12:27,  5.29it/s]Computing perplexity:   0%|          | 10/3960 [00:01<12:29,  5.27it/s]Computing perplexity:   0%|          | 11/3960 [00:02<12:26,  5.29it/s]Computing perplexity:   0%|          | 12/3960 [00:02<12:27,  5.28it/s]Computing perplexity:   0%|          | 13/3960 [00:02<12:25,  5.29it/s]Computing perplexity:   0%|          | 14/3960 [00:02<12:26,  5.29it/s]Computing perplexity:   0%|          | 15/3960 [00:02<12:26,  5.29it/s]Computing perplexity:   0%|          | 16/3960 [00:03<12:26,  5.29it/s]Computing perplexity:   0%|          | 17/3960 [00:03<12:26,  5.28it/s]Computing perplexity:   0%|          | 18/3960 [00:03<12:25,  5.29it/s]Computing perplexity:   0%|          | 19/3960 [00:03<12:26,  5.28it/s]Computing perplexity:   1%|          | 20/3960 [00:03<12:24,  5.29it/s]Computing perplexity:   1%|          | 21/3960 [00:03<12:25,  5.28it/s]Computing perplexity:   1%|          | 22/3960 [00:04<12:24,  5.29it/s]Computing perplexity:   1%|          | 23/3960 [00:04<12:26,  5.28it/s]Computing perplexity:   1%|          | 24/3960 [00:04<12:23,  5.30it/s]Computing perplexity:   1%|          | 25/3960 [00:04<12:25,  5.28it/s]Computing perplexity:   1%|          | 26/3960 [00:04<12:23,  5.29it/s]Computing perplexity:   1%|          | 27/3960 [00:05<12:23,  5.29it/s]Computing perplexity:   1%|          | 28/3960 [00:05<12:23,  5.29it/s]Computing perplexity:   1%|          | 29/3960 [00:05<12:22,  5.30it/s]Computing perplexity:   1%|          | 30/3960 [00:05<12:22,  5.29it/s]Computing perplexity:   1%|          | 31/3960 [00:05<12:21,  5.30it/s]Computing perplexity:   1%|          | 32/3960 [00:06<12:23,  5.28it/s]Computing perplexity:   1%|          | 33/3960 [00:06<12:21,  5.30it/s]Computing perplexity:   1%|          | 34/3960 [00:06<12:24,  5.28it/s]Computing perplexity:   1%|          | 35/3960 [00:06<12:21,  5.29it/s]Computing perplexity:   1%|          | 36/3960 [00:06<12:22,  5.28it/s]Computing perplexity:   1%|          | 37/3960 [00:06<12:21,  5.29it/s]Computing perplexity:   1%|          | 38/3960 [00:07<12:21,  5.29it/s]Computing perplexity:   1%|          | 39/3960 [00:07<12:20,  5.29it/s]Computing perplexity:   1%|          | 40/3960 [00:07<12:20,  5.30it/s]Computing perplexity:   1%|          | 41/3960 [00:07<12:21,  5.29it/s]Computing perplexity:   1%|          | 42/3960 [00:07<12:19,  5.30it/s]Computing perplexity:   1%|          | 43/3960 [00:08<12:21,  5.28it/s]Computing perplexity:   1%|          | 44/3960 [00:08<12:20,  5.29it/s]Computing perplexity:   1%|          | 45/3960 [00:08<12:22,  5.27it/s]Computing perplexity:   1%|          | 46/3960 [00:08<12:21,  5.28it/s]Computing perplexity:   1%|          | 47/3960 [00:08<12:23,  5.26it/s]Computing perplexity:   1%|          | 48/3960 [00:09<12:21,  5.28it/s]Computing perplexity:   1%|          | 49/3960 [00:09<12:23,  5.26it/s]Computing perplexity:   1%|▏         | 50/3960 [00:09<12:21,  5.27it/s]Computing perplexity:   1%|▏         | 51/3960 [00:09<12:22,  5.26it/s]Computing perplexity:   1%|▏         | 52/3960 [00:09<12:19,  5.28it/s]Computing perplexity:   1%|▏         | 53/3960 [00:10<12:22,  5.26it/s]Computing perplexity:   1%|▏         | 54/3960 [00:10<12:19,  5.29it/s]Computing perplexity:   1%|▏         | 55/3960 [00:10<12:19,  5.28it/s]Computing perplexity:   1%|▏         | 56/3960 [00:10<12:18,  5.29it/s]Computing perplexity:   1%|▏         | 57/3960 [00:10<12:19,  5.28it/s]Computing perplexity:   1%|▏         | 58/3960 [00:10<12:18,  5.29it/s]Computing perplexity:   1%|▏         | 59/3960 [00:11<12:17,  5.29it/s]Computing perplexity:   2%|▏         | 60/3960 [00:11<12:17,  5.28it/s]Computing perplexity:   2%|▏         | 61/3960 [00:11<12:15,  5.30it/s]Computing perplexity:   2%|▏         | 62/3960 [00:11<12:17,  5.28it/s]Computing perplexity:   2%|▏         | 63/3960 [00:11<12:16,  5.29it/s]Computing perplexity:   2%|▏         | 64/3960 [00:12<12:18,  5.28it/s]Computing perplexity:   2%|▏         | 65/3960 [00:12<12:16,  5.29it/s]Computing perplexity:   2%|▏         | 66/3960 [00:12<12:22,  5.24it/s]Computing perplexity:   2%|▏         | 67/3960 [00:12<12:20,  5.26it/s]Computing perplexity:   2%|▏         | 68/3960 [00:12<12:19,  5.27it/s]Computing perplexity:   2%|▏         | 69/3960 [00:13<12:17,  5.28it/s]Computing perplexity:   2%|▏         | 70/3960 [00:13<12:18,  5.27it/s]Computing perplexity:   2%|▏         | 71/3960 [00:13<12:17,  5.28it/s]Computing perplexity:   2%|▏         | 72/3960 [00:13<12:19,  5.26it/s]Computing perplexity:   2%|▏         | 73/3960 [00:13<12:16,  5.27it/s]Computing perplexity:   2%|▏         | 74/3960 [00:14<12:18,  5.26it/s]Computing perplexity:   2%|▏         | 75/3960 [00:14<12:15,  5.28it/s]Computing perplexity:   2%|▏         | 76/3960 [00:14<12:17,  5.26it/s]Computing perplexity:   2%|▏         | 77/3960 [00:14<12:14,  5.29it/s]Computing perplexity:   2%|▏         | 78/3960 [00:14<12:15,  5.28it/s]Computing perplexity:   2%|▏         | 79/3960 [00:14<12:14,  5.29it/s]Computing perplexity:   2%|▏         | 80/3960 [00:15<12:15,  5.28it/s]Computing perplexity:   2%|▏         | 81/3960 [00:15<12:13,  5.28it/s]Computing perplexity:   2%|▏         | 82/3960 [00:15<12:14,  5.28it/s]Computing perplexity:   2%|▏         | 83/3960 [00:15<12:13,  5.29it/s]Computing perplexity:   2%|▏         | 84/3960 [00:15<12:12,  5.29it/s]Computing perplexity:   2%|▏         | 85/3960 [00:16<12:14,  5.28it/s]Computing perplexity:   2%|▏         | 86/3960 [00:16<12:11,  5.29it/s]Computing perplexity:   2%|▏         | 87/3960 [00:16<12:13,  5.28it/s]Computing perplexity:   2%|▏         | 88/3960 [00:16<12:11,  5.29it/s]Computing perplexity:   2%|▏         | 89/3960 [00:16<12:13,  5.28it/s]Computing perplexity:   2%|▏         | 90/3960 [00:17<12:11,  5.29it/s]Computing perplexity:   2%|▏         | 91/3960 [00:17<12:13,  5.27it/s]Computing perplexity:   2%|▏         | 92/3960 [00:17<12:11,  5.29it/s]Computing perplexity:   2%|▏         | 93/3960 [00:17<12:12,  5.28it/s]Computing perplexity:   2%|▏         | 94/3960 [00:17<12:10,  5.29it/s]Computing perplexity:   2%|▏         | 95/3960 [00:17<12:11,  5.28it/s]Computing perplexity:   2%|▏         | 96/3960 [00:18<12:10,  5.29it/s]Computing perplexity:   2%|▏         | 97/3960 [00:18<12:09,  5.29it/s]Computing perplexity:   2%|▏         | 98/3960 [00:18<12:11,  5.28it/s]Computing perplexity:   2%|▎         | 99/3960 [00:18<12:09,  5.29it/s]                                                                         Computing MIA resistance...
    Forget Efficacy: 0.00%
    Retain Performance: 100.00%
    MIA Resistance: 64.29%

============================================================
Method: Gradient Ascent (GA)
============================================================
  Resetting model to fresh state...
Loading model: Qwen/Qwen3-4B-Instruct-2507
Quantization: True, LoRA: True
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:00<00:01,  1.12it/s]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:01<00:00,  1.03it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:01<00:00,  1.54it/s]
trainable params: 11,796,480 || all params: 4,034,264,576 || trainable%: 0.2924
Epoch 1/1:   0%|          | 0/40 [00:00<?, ?it/s]Epoch 1/1:   2%|▎         | 1/40 [00:00<00:24,  1.57it/s]Epoch 1/1:   5%|▌         | 2/40 [00:01<00:23,  1.59it/s]Epoch 1/1:   8%|▊         | 3/40 [00:01<00:23,  1.60it/s]Epoch 1/1:  10%|█         | 4/40 [00:02<00:22,  1.60it/s]Epoch 1/1:  12%|█▎        | 5/40 [00:03<00:21,  1.60it/s]Epoch 1/1:  15%|█▌        | 6/40 [00:03<00:21,  1.60it/s]Epoch 1/1:  18%|█▊        | 7/40 [00:04<00:20,  1.60it/s]Epoch 1/1:  20%|██        | 8/40 [00:05<00:20,  1.60it/s]Epoch 1/1:  22%|██▎       | 9/40 [00:05<00:19,  1.60it/s]Epoch 1/1:  22%|██▎       | 9/40 [00:06<00:19,  1.60it/s, loss=18.4]Epoch 1/1:  25%|██▌       | 10/40 [00:06<00:18,  1.60it/s, loss=18.4]Epoch 1/1:  28%|██▊       | 11/40 [00:06<00:18,  1.60it/s, loss=18.4]Epoch 1/1:  30%|███       | 12/40 [00:07<00:17,  1.60it/s, loss=18.4]Epoch 1/1:  32%|███▎      | 13/40 [00:08<00:16,  1.60it/s, loss=18.4]Epoch 1/1:  35%|███▌      | 14/40 [00:08<00:16,  1.60it/s, loss=18.4]Epoch 1/1:  38%|███▊      | 15/40 [00:09<00:15,  1.60it/s, loss=18.4]Epoch 1/1:  40%|████      | 16/40 [00:10<00:15,  1.60it/s, loss=18.4]Epoch 1/1:  42%|████▎     | 17/40 [00:10<00:14,  1.60it/s, loss=18.4]Epoch 1/1:  45%|████▌     | 18/40 [00:11<00:13,  1.60it/s, loss=18.4]Epoch 1/1:  48%|████▊     | 19/40 [00:11<00:13,  1.60it/s, loss=18.4]Epoch 1/1:  48%|████▊     | 19/40 [00:12<00:13,  1.60it/s, loss=20.4]Epoch 1/1:  50%|█████     | 20/40 [00:12<00:12,  1.60it/s, loss=20.4]Epoch 1/1:  52%|█████▎    | 21/40 [00:13<00:11,  1.60it/s, loss=20.4]Epoch 1/1:  55%|█████▌    | 22/40 [00:13<00:11,  1.60it/s, loss=20.4]Epoch 1/1:  57%|█████▊    | 23/40 [00:14<00:10,  1.60it/s, loss=20.4]Epoch 1/1:  60%|██████    | 24/40 [00:15<00:10,  1.60it/s, loss=20.4]Epoch 1/1:  62%|██████▎   | 25/40 [00:15<00:09,  1.60it/s, loss=20.4]Epoch 1/1:  65%|██████▌   | 26/40 [00:16<00:08,  1.60it/s, loss=20.4]Epoch 1/1:  68%|██████▊   | 27/40 [00:16<00:08,  1.60it/s, loss=20.4]Epoch 1/1:  70%|███████   | 28/40 [00:17<00:07,  1.60it/s, loss=20.4]Epoch 1/1:  72%|███████▎  | 29/40 [00:18<00:06,  1.59it/s, loss=20.4]Epoch 1/1:  72%|███████▎  | 29/40 [00:18<00:06,  1.59it/s, loss=23.2]Epoch 1/1:  75%|███████▌  | 30/40 [00:18<00:06,  1.59it/s, loss=23.2]Epoch 1/1:  78%|███████▊  | 31/40 [00:19<00:05,  1.60it/s, loss=23.2]Epoch 1/1:  80%|████████  | 32/40 [00:20<00:05,  1.59it/s, loss=23.2]Epoch 1/1:  82%|████████▎ | 33/40 [00:20<00:04,  1.60it/s, loss=23.2]Epoch 1/1:  85%|████████▌ | 34/40 [00:21<00:03,  1.60it/s, loss=23.2]Epoch 1/1:  88%|████████▊ | 35/40 [00:21<00:03,  1.60it/s, loss=23.2]Epoch 1/1:  90%|█████████ | 36/40 [00:22<00:02,  1.60it/s, loss=23.2]Epoch 1/1:  92%|█████████▎| 37/40 [00:23<00:01,  1.59it/s, loss=23.2]Epoch 1/1:  95%|█████████▌| 38/40 [00:23<00:01,  1.59it/s, loss=23.2]Epoch 1/1:  98%|█████████▊| 39/40 [00:24<00:00,  1.59it/s, loss=23.2]Epoch 1/1:  98%|█████████▊| 39/40 [00:25<00:00,  1.59it/s, loss=29.7]Epoch 1/1: 100%|██████████| 40/40 [00:25<00:00,  1.59it/s, loss=29.7]Epoch 1/1: 100%|██████████| 40/40 [00:25<00:00,  1.60it/s, loss=29.7]
  Evaluating Gradient Ascent (GA)...
Running full evaluation...
  Computing forget efficacy...
Computing perplexity:   0%|          | 0/40 [00:00<?, ?it/s]Computing perplexity:   2%|▎         | 1/40 [00:00<00:07,  5.47it/s]Computing perplexity:   5%|▌         | 2/40 [00:00<00:07,  5.37it/s]Computing perplexity:   8%|▊         | 3/40 [00:00<00:06,  5.30it/s]Computing perplexity:  10%|█         | 4/40 [00:00<00:06,  5.31it/s]Computing perplexity:  12%|█▎        | 5/40 [00:00<00:06,  5.27it/s]Computing perplexity:  15%|█▌        | 6/40 [00:01<00:06,  5.28it/s]Computing perplexity:  18%|█▊        | 7/40 [00:01<00:06,  5.26it/s]Computing perplexity:  20%|██        | 8/40 [00:01<00:06,  5.27it/s]Computing perplexity:  22%|██▎       | 9/40 [00:01<00:05,  5.26it/s]Computing perplexity:  25%|██▌       | 10/40 [00:01<00:05,  5.28it/s]Computing perplexity:  28%|██▊       | 11/40 [00:02<00:05,  5.25it/s]Computing perplexity:  30%|███       | 12/40 [00:02<00:05,  5.27it/s]Computing perplexity:  32%|███▎      | 13/40 [00:02<00:05,  5.26it/s]Computing perplexity:  35%|███▌      | 14/40 [00:02<00:04,  5.27it/s]Computing perplexity:  38%|███▊      | 15/40 [00:02<00:04,  5.25it/s]Computing perplexity:  40%|████      | 16/40 [00:03<00:04,  5.27it/s]Computing perplexity:  42%|████▎     | 17/40 [00:03<00:04,  5.26it/s]Computing perplexity:  45%|████▌     | 18/40 [00:03<00:04,  5.27it/s]Computing perplexity:  48%|████▊     | 19/40 [00:03<00:03,  5.26it/s]Computing perplexity:  50%|█████     | 20/40 [00:03<00:03,  5.28it/s]Computing perplexity:  52%|█████▎    | 21/40 [00:03<00:03,  5.26it/s]Computing perplexity:  55%|█████▌    | 22/40 [00:04<00:03,  5.27it/s]Computing perplexity:  57%|█████▊    | 23/40 [00:04<00:03,  5.26it/s]Computing perplexity:  60%|██████    | 24/40 [00:04<00:03,  5.27it/s]Computing perplexity:  62%|██████▎   | 25/40 [00:04<00:02,  5.26it/s]Computing perplexity:  65%|██████▌   | 26/40 [00:04<00:02,  5.28it/s]Computing perplexity:  68%|██████▊   | 27/40 [00:05<00:02,  5.25it/s]Computing perplexity:  70%|███████   | 28/40 [00:05<00:02,  5.27it/s]Computing perplexity:  72%|███████▎  | 29/40 [00:05<00:02,  5.26it/s]Computing perplexity:  75%|███████▌  | 30/40 [00:05<00:01,  5.26it/s]Computing perplexity:  78%|███████▊  | 31/40 [00:05<00:01,  5.26it/s]Computing perplexity:  80%|████████  | 32/40 [00:06<00:01,  5.28it/s]Computing perplexity:  82%|████████▎ | 33/40 [00:06<00:01,  5.26it/s]Computing perplexity:  85%|████████▌ | 34/40 [00:06<00:01,  5.27it/s]Computing perplexity:  88%|████████▊ | 35/40 [00:06<00:00,  5.26it/s]Computing perplexity:  90%|█████████ | 36/40 [00:06<00:00,  5.27it/s]Computing perplexity:  92%|█████████▎| 37/40 [00:07<00:00,  5.25it/s]Computing perplexity:  95%|█████████▌| 38/40 [00:07<00:00,  5.27it/s]Computing perplexity:  98%|█████████▊| 39/40 [00:07<00:00,  5.26it/s]Computing perplexity: 100%|██████████| 40/40 [00:07<00:00,  5.28it/s]                                                                       Computing retain performance...
Computing perplexity:   0%|          | 0/3960 [00:00<?, ?it/s]Computing perplexity:   0%|          | 1/3960 [00:00<12:32,  5.26it/s]Computing perplexity:   0%|          | 2/3960 [00:00<12:28,  5.29it/s]Computing perplexity:   0%|          | 3/3960 [00:00<12:32,  5.26it/s]Computing perplexity:   0%|          | 4/3960 [00:00<12:30,  5.27it/s]Computing perplexity:   0%|          | 5/3960 [00:00<12:31,  5.26it/s]Computing perplexity:   0%|          | 6/3960 [00:01<12:30,  5.27it/s]Computing perplexity:   0%|          | 7/3960 [00:01<12:31,  5.26it/s]Computing perplexity:   0%|          | 8/3960 [00:01<12:29,  5.27it/s]Computing perplexity:   0%|          | 9/3960 [00:01<12:30,  5.26it/s]Computing perplexity:   0%|          | 10/3960 [00:01<12:29,  5.27it/s]Computing perplexity:   0%|          | 11/3960 [00:02<12:30,  5.26it/s]Computing perplexity:   0%|          | 12/3960 [00:02<12:27,  5.28it/s]Computing perplexity:   0%|          | 13/3960 [00:02<12:29,  5.26it/s]Computing perplexity:   0%|          | 14/3960 [00:02<12:27,  5.28it/s]Computing perplexity:   0%|          | 15/3960 [00:02<12:29,  5.26it/s]Computing perplexity:   0%|          | 16/3960 [00:03<12:27,  5.28it/s]Computing perplexity:   0%|          | 17/3960 [00:03<12:28,  5.26it/s]Computing perplexity:   0%|          | 18/3960 [00:03<12:27,  5.28it/s]Computing perplexity:   0%|          | 19/3960 [00:03<12:29,  5.26it/s]Computing perplexity:   1%|          | 20/3960 [00:03<12:27,  5.27it/s]Computing perplexity:   1%|          | 21/3960 [00:03<12:28,  5.26it/s]Computing perplexity:   1%|          | 22/3960 [00:04<12:27,  5.27it/s]Computing perplexity:   1%|          | 23/3960 [00:04<12:28,  5.26it/s]Computing perplexity:   1%|          | 24/3960 [00:04<12:26,  5.27it/s]Computing perplexity:   1%|          | 25/3960 [00:04<12:28,  5.26it/s]Computing perplexity:   1%|          | 26/3960 [00:04<12:26,  5.27it/s]Computing perplexity:   1%|          | 27/3960 [00:05<12:27,  5.26it/s]Computing perplexity:   1%|          | 28/3960 [00:05<12:25,  5.28it/s]Computing perplexity:   1%|          | 29/3960 [00:05<12:27,  5.26it/s]Computing perplexity:   1%|          | 30/3960 [00:05<12:24,  5.28it/s]Computing perplexity:   1%|          | 31/3960 [00:05<12:27,  5.25it/s]Computing perplexity:   1%|          | 32/3960 [00:06<12:24,  5.27it/s]Computing perplexity:   1%|          | 33/3960 [00:06<12:26,  5.26it/s]Computing perplexity:   1%|          | 34/3960 [00:06<12:24,  5.27it/s]Computing perplexity:   1%|          | 35/3960 [00:06<12:26,  5.26it/s]Computing perplexity:   1%|          | 36/3960 [00:06<12:24,  5.27it/s]Computing perplexity:   1%|          | 37/3960 [00:07<12:25,  5.26it/s]Computing perplexity:   1%|          | 38/3960 [00:07<12:24,  5.27it/s]Computing perplexity:   1%|          | 39/3960 [00:07<12:25,  5.26it/s]Computing perplexity:   1%|          | 40/3960 [00:07<12:23,  5.27it/s]Computing perplexity:   1%|          | 41/3960 [00:07<12:26,  5.25it/s]Computing perplexity:   1%|          | 42/3960 [00:07<12:23,  5.27it/s]Computing perplexity:   1%|          | 43/3960 [00:08<12:24,  5.26it/s]Computing perplexity:   1%|          | 44/3960 [00:08<12:22,  5.27it/s]Computing perplexity:   1%|          | 45/3960 [00:08<12:24,  5.26it/s]Computing perplexity:   1%|          | 46/3960 [00:08<12:21,  5.28it/s]Computing perplexity:   1%|          | 47/3960 [00:08<12:24,  5.25it/s]Computing perplexity:   1%|          | 48/3960 [00:09<12:22,  5.27it/s]Computing perplexity:   1%|          | 49/3960 [00:09<12:24,  5.26it/s]Computing perplexity:   1%|▏         | 50/3960 [00:09<12:22,  5.26it/s]Computing perplexity:   1%|▏         | 51/3960 [00:09<12:23,  5.26it/s]Computing perplexity:   1%|▏         | 52/3960 [00:09<12:21,  5.27it/s]Computing perplexity:   1%|▏         | 53/3960 [00:10<12:23,  5.26it/s]Computing perplexity:   1%|▏         | 54/3960 [00:10<12:22,  5.26it/s]Computing perplexity:   1%|▏         | 55/3960 [00:10<12:23,  5.26it/s]Computing perplexity:   1%|▏         | 56/3960 [00:10<12:20,  5.27it/s]Computing perplexity:   1%|▏         | 57/3960 [00:10<12:22,  5.26it/s]Computing perplexity:   1%|▏         | 58/3960 [00:11<12:19,  5.27it/s]Computing perplexity:   1%|▏         | 59/3960 [00:11<12:21,  5.26it/s]Computing perplexity:   2%|▏         | 60/3960 [00:11<12:19,  5.28it/s]Computing perplexity:   2%|▏         | 61/3960 [00:11<12:20,  5.26it/s]Computing perplexity:   2%|▏         | 62/3960 [00:11<12:18,  5.28it/s]Computing perplexity:   2%|▏         | 63/3960 [00:11<12:21,  5.26it/s]Computing perplexity:   2%|▏         | 64/3960 [00:12<12:18,  5.28it/s]Computing perplexity:   2%|▏         | 65/3960 [00:12<12:20,  5.26it/s]Computing perplexity:   2%|▏         | 66/3960 [00:12<12:18,  5.27it/s]Computing perplexity:   2%|▏         | 67/3960 [00:12<12:20,  5.26it/s]Computing perplexity:   2%|▏         | 68/3960 [00:12<12:18,  5.27it/s]Computing perplexity:   2%|▏         | 69/3960 [00:13<12:20,  5.25it/s]Computing perplexity:   2%|▏         | 70/3960 [00:13<12:18,  5.27it/s]Computing perplexity:   2%|▏         | 71/3960 [00:13<12:19,  5.26it/s]Computing perplexity:   2%|▏         | 72/3960 [00:13<12:16,  5.28it/s]Computing perplexity:   2%|▏         | 73/3960 [00:13<12:19,  5.26it/s]Computing perplexity:   2%|▏         | 74/3960 [00:14<12:16,  5.28it/s]Computing perplexity:   2%|▏         | 75/3960 [00:14<12:18,  5.26it/s]Computing perplexity:   2%|▏         | 76/3960 [00:14<12:16,  5.27it/s]Computing perplexity:   2%|▏         | 77/3960 [00:14<12:18,  5.26it/s]Computing perplexity:   2%|▏         | 78/3960 [00:14<12:15,  5.28it/s]Computing perplexity:   2%|▏         | 79/3960 [00:15<12:18,  5.26it/s]Computing perplexity:   2%|▏         | 80/3960 [00:15<12:15,  5.27it/s]Computing perplexity:   2%|▏         | 81/3960 [00:15<12:17,  5.26it/s]Computing perplexity:   2%|▏         | 82/3960 [00:15<12:16,  5.26it/s]Computing perplexity:   2%|▏         | 83/3960 [00:15<12:17,  5.26it/s]Computing perplexity:   2%|▏         | 84/3960 [00:15<12:16,  5.26it/s]Computing perplexity:   2%|▏         | 85/3960 [00:16<12:17,  5.25it/s]Computing perplexity:   2%|▏         | 86/3960 [00:16<12:16,  5.26it/s]Computing perplexity:   2%|▏         | 87/3960 [00:16<12:16,  5.26it/s]Computing perplexity:   2%|▏         | 88/3960 [00:16<12:15,  5.27it/s]Computing perplexity:   2%|▏         | 89/3960 [00:16<12:16,  5.26it/s]Computing perplexity:   2%|▏         | 90/3960 [00:17<12:13,  5.28it/s]Computing perplexity:   2%|▏         | 91/3960 [00:17<12:16,  5.26it/s]Computing perplexity:   2%|▏         | 92/3960 [00:17<12:13,  5.27it/s]Computing perplexity:   2%|▏         | 93/3960 [00:17<12:14,  5.26it/s]Computing perplexity:   2%|▏         | 94/3960 [00:17<12:11,  5.28it/s]Computing perplexity:   2%|▏         | 95/3960 [00:18<12:14,  5.26it/s]Computing perplexity:   2%|▏         | 96/3960 [00:18<12:12,  5.27it/s]Computing perplexity:   2%|▏         | 97/3960 [00:18<12:14,  5.26it/s]Computing perplexity:   2%|▏         | 98/3960 [00:18<12:13,  5.27it/s]Computing perplexity:   2%|▎         | 99/3960 [00:18<12:14,  5.25it/s]                                                                         Computing MIA resistance...
    Forget Efficacy: 100.00%
    Retain Performance: 0.00%
    MIA Resistance: 100.00%

============================================================
Method: Dual Signed Adaptation Unlearning (DSU)
============================================================
  Resetting model to fresh state...
Loading model: Qwen/Qwen3-4B-Instruct-2507
Quantization: True, LoRA: True
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:00<00:01,  1.07it/s]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:01<00:00,  1.01it/s]Loading checkpoint shards: 100%|██████████| 3/3 [00:01<00:00,  1.51it/s]
trainable params: 11,796,480 || all params: 4,034,264,576 || trainable%: 0.2924
DSU Epoch 1/3:   0%|          | 0/40 [00:00<?, ?it/s]DSU Epoch 1/3:   2%|▎         | 1/40 [00:01<00:48,  1.26s/it]DSU Epoch 1/3:   5%|▌         | 2/40 [00:02<00:47,  1.25s/it]DSU Epoch 1/3:   8%|▊         | 3/40 [00:03<00:46,  1.25s/it]DSU Epoch 1/3:  10%|█         | 4/40 [00:05<00:45,  1.25s/it]DSU Epoch 1/3:  12%|█▎        | 5/40 [00:06<00:43,  1.25s/it]DSU Epoch 1/3:  15%|█▌        | 6/40 [00:07<00:42,  1.25s/it]DSU Epoch 1/3:  18%|█▊        | 7/40 [00:08<00:41,  1.25s/it]DSU Epoch 1/3:  20%|██        | 8/40 [00:10<00:40,  1.25s/it]DSU Epoch 1/3:  22%|██▎       | 9/40 [00:11<00:38,  1.25s/it]DSU Epoch 1/3:  22%|██▎       | 9/40 [00:12<00:38,  1.25s/it, forget_loss=14.9651, retain_loss=14.3731, total_loss=86.8305]DSU Epoch 1/3:  25%|██▌       | 10/40 [00:12<00:37,  1.25s/it, forget_loss=14.9651, retain_loss=14.3731, total_loss=86.8305]DSU Epoch 1/3:  28%|██▊       | 11/40 [00:13<00:36,  1.25s/it, forget_loss=14.9651, retain_loss=14.3731, total_loss=86.8305]DSU Epoch 1/3:  30%|███       | 12/40 [00:15<00:35,  1.25s/it, forget_loss=14.9651, retain_loss=14.3731, total_loss=86.8305]DSU Epoch 1/3:  32%|███▎      | 13/40 [00:16<00:33,  1.25s/it, forget_loss=14.9651, retain_loss=14.3731, total_loss=86.8305]DSU Epoch 1/3:  35%|███▌      | 14/40 [00:17<00:32,  1.25s/it, forget_loss=14.9651, retain_loss=14.3731, total_loss=86.8305]DSU Epoch 1/3:  38%|███▊      | 15/40 [00:18<00:31,  1.25s/it, forget_loss=14.9651, retain_loss=14.3731, total_loss=86.8305]DSU Epoch 1/3:  40%|████      | 16/40 [00:20<00:30,  1.25s/it, forget_loss=14.9651, retain_loss=14.3731, total_loss=86.8305]DSU Epoch 1/3:  42%|████▎     | 17/40 [00:21<00:28,  1.25s/it, forget_loss=14.9651, retain_loss=14.3731, total_loss=86.8305]DSU Epoch 1/3:  45%|████▌     | 18/40 [00:22<00:27,  1.25s/it, forget_loss=14.9651, retain_loss=14.3731, total_loss=86.8305]DSU Epoch 1/3:  48%|████▊     | 19/40 [00:23<00:26,  1.25s/it, forget_loss=14.9651, retain_loss=14.3731, total_loss=86.8305]DSU Epoch 1/3:  48%|████▊     | 19/40 [00:25<00:26,  1.25s/it, forget_loss=13.3791, retain_loss=12.6365, total_loss=76.5613]DSU Epoch 1/3:  50%|█████     | 20/40 [00:25<00:25,  1.25s/it, forget_loss=13.3791, retain_loss=12.6365, total_loss=76.5613]DSU Epoch 1/3:  52%|█████▎    | 21/40 [00:26<00:23,  1.25s/it, forget_loss=13.3791, retain_loss=12.6365, total_loss=76.5613]DSU Epoch 1/3:  55%|█████▌    | 22/40 [00:27<00:22,  1.25s/it, forget_loss=13.3791, retain_loss=12.6365, total_loss=76.5613]DSU Epoch 1/3:  57%|█████▊    | 23/40 [00:28<00:21,  1.25s/it, forget_loss=13.3791, retain_loss=12.6365, total_loss=76.5613]DSU Epoch 1/3:  60%|██████    | 24/40 [00:30<00:20,  1.25s/it, forget_loss=13.3791, retain_loss=12.6365, total_loss=76.5613]DSU Epoch 1/3:  62%|██████▎   | 25/40 [00:31<00:18,  1.25s/it, forget_loss=13.3791, retain_loss=12.6365, total_loss=76.5613]DSU Epoch 1/3:  65%|██████▌   | 26/40 [00:32<00:17,  1.25s/it, forget_loss=13.3791, retain_loss=12.6365, total_loss=76.5613]DSU Epoch 1/3:  68%|██████▊   | 27/40 [00:33<00:16,  1.25s/it, forget_loss=13.3791, retain_loss=12.6365, total_loss=76.5613]DSU Epoch 1/3:  70%|███████   | 28/40 [00:35<00:15,  1.25s/it, forget_loss=13.3791, retain_loss=12.6365, total_loss=76.5613]DSU Epoch 1/3:  72%|███████▎  | 29/40 [00:36<00:13,  1.25s/it, forget_loss=13.3791, retain_loss=12.6365, total_loss=76.5613]DSU Epoch 1/3:  72%|███████▎  | 29/40 [00:37<00:13,  1.25s/it, forget_loss=7.6912, retain_loss=7.3713, total_loss=44.5480]  DSU Epoch 1/3:  75%|███████▌  | 30/40 [00:37<00:12,  1.25s/it, forget_loss=7.6912, retain_loss=7.3713, total_loss=44.5480]DSU Epoch 1/3:  78%|███████▊  | 31/40 [00:38<00:11,  1.25s/it, forget_loss=7.6912, retain_loss=7.3713, total_loss=44.5480]DSU Epoch 1/3:  80%|████████  | 32/40 [00:40<00:10,  1.25s/it, forget_loss=7.6912, retain_loss=7.3713, total_loss=44.5480]DSU Epoch 1/3:  82%|████████▎ | 33/40 [00:41<00:08,  1.25s/it, forget_loss=7.6912, retain_loss=7.3713, total_loss=44.5480]DSU Epoch 1/3:  85%|████████▌ | 34/40 [00:42<00:07,  1.25s/it, forget_loss=7.6912, retain_loss=7.3713, total_loss=44.5480]DSU Epoch 1/3:  88%|████████▊ | 35/40 [00:43<00:06,  1.25s/it, forget_loss=7.6912, retain_loss=7.3713, total_loss=44.5480]DSU Epoch 1/3:  90%|█████████ | 36/40 [00:45<00:05,  1.25s/it, forget_loss=7.6912, retain_loss=7.3713, total_loss=44.5480]DSU Epoch 1/3:  92%|█████████▎| 37/40 [00:46<00:03,  1.25s/it, forget_loss=7.6912, retain_loss=7.3713, total_loss=44.5480]DSU Epoch 1/3:  95%|█████████▌| 38/40 [00:47<00:02,  1.25s/it, forget_loss=7.6912, retain_loss=7.3713, total_loss=44.5480]DSU Epoch 1/3:  98%|█████████▊| 39/40 [00:48<00:01,  1.25s/it, forget_loss=7.6912, retain_loss=7.3713, total_loss=44.5480]DSU Epoch 1/3:  98%|█████████▊| 39/40 [00:50<00:01,  1.25s/it, forget_loss=1.1648, retain_loss=2.7706, total_loss=15.0178]DSU Epoch 1/3: 100%|██████████| 40/40 [00:50<00:00,  1.25s/it, forget_loss=1.1648, retain_loss=2.7706, total_loss=15.0178]DSU Epoch 1/3: 100%|██████████| 40/40 [00:50<00:00,  1.25s/it, forget_loss=1.1648, retain_loss=2.7706, total_loss=15.0178]
DSU Epoch 2/3:   0%|          | 0/40 [00:00<?, ?it/s]DSU Epoch 2/3:   2%|▎         | 1/40 [00:01<00:48,  1.25s/it]DSU Epoch 2/3:   5%|▌         | 2/40 [00:02<00:47,  1.25s/it]DSU Epoch 2/3:   8%|▊         | 3/40 [00:03<00:46,  1.25s/it]DSU Epoch 2/3:  10%|█         | 4/40 [00:05<00:45,  1.26s/it]DSU Epoch 2/3:  12%|█▎        | 5/40 [00:06<00:43,  1.26s/it]DSU Epoch 2/3:  15%|█▌        | 6/40 [00:07<00:42,  1.25s/it]DSU Epoch 2/3:  18%|█▊        | 7/40 [00:08<00:41,  1.25s/it]DSU Epoch 2/3:  20%|██        | 8/40 [00:10<00:40,  1.26s/it]DSU Epoch 2/3:  22%|██▎       | 9/40 [00:11<00:38,  1.26s/it]DSU Epoch 2/3:  22%|██▎       | 9/40 [00:12<00:38,  1.26s/it, forget_loss=1.0070, retain_loss=0.4711, total_loss=3.3626]DSU Epoch 2/3:  25%|██▌       | 10/40 [00:12<00:37,  1.26s/it, forget_loss=1.0070, retain_loss=0.4711, total_loss=3.3626]DSU Epoch 2/3:  28%|██▊       | 11/40 [00:13<00:36,  1.26s/it, forget_loss=1.0070, retain_loss=0.4711, total_loss=3.3626]DSU Epoch 2/3:  30%|███       | 12/40 [00:15<00:35,  1.26s/it, forget_loss=1.0070, retain_loss=0.4711, total_loss=3.3626]DSU Epoch 2/3:  32%|███▎      | 13/40 [00:16<00:33,  1.26s/it, forget_loss=1.0070, retain_loss=0.4711, total_loss=3.3626]DSU Epoch 2/3:  35%|███▌      | 14/40 [00:17<00:32,  1.25s/it, forget_loss=1.0070, retain_loss=0.4711, total_loss=3.3626]DSU Epoch 2/3:  38%|███▊      | 15/40 [00:18<00:31,  1.26s/it, forget_loss=1.0070, retain_loss=0.4711, total_loss=3.3626]DSU Epoch 2/3:  40%|████      | 16/40 [00:20<00:30,  1.26s/it, forget_loss=1.0070, retain_loss=0.4711, total_loss=3.3626]DSU Epoch 2/3:  42%|████▎     | 17/40 [00:21<00:28,  1.26s/it, forget_loss=1.0070, retain_loss=0.4711, total_loss=3.3626]DSU Epoch 2/3:  45%|████▌     | 18/40 [00:22<00:27,  1.26s/it, forget_loss=1.0070, retain_loss=0.4711, total_loss=3.3626]DSU Epoch 2/3:  48%|████▊     | 19/40 [00:23<00:26,  1.25s/it, forget_loss=1.0070, retain_loss=0.4711, total_loss=3.3626]DSU Epoch 2/3:  48%|████▊     | 19/40 [00:25<00:26,  1.25s/it, forget_loss=0.9155, retain_loss=0.5706, total_loss=3.7688]DSU Epoch 2/3:  50%|█████     | 20/40 [00:25<00:25,  1.26s/it, forget_loss=0.9155, retain_loss=0.5706, total_loss=3.7688]DSU Epoch 2/3:  52%|█████▎    | 21/40 [00:26<00:23,  1.26s/it, forget_loss=0.9155, retain_loss=0.5706, total_loss=3.7688]DSU Epoch 2/3:  55%|█████▌    | 22/40 [00:27<00:22,  1.25s/it, forget_loss=0.9155, retain_loss=0.5706, total_loss=3.7688]DSU Epoch 2/3:  57%|█████▊    | 23/40 [00:28<00:21,  1.25s/it, forget_loss=0.9155, retain_loss=0.5706, total_loss=3.7688]DSU Epoch 2/3:  60%|██████    | 24/40 [00:30<00:20,  1.26s/it, forget_loss=0.9155, retain_loss=0.5706, total_loss=3.7688]DSU Epoch 2/3:  62%|██████▎   | 25/40 [00:31<00:18,  1.26s/it, forget_loss=0.9155, retain_loss=0.5706, total_loss=3.7688]DSU Epoch 2/3:  65%|██████▌   | 26/40 [00:32<00:17,  1.25s/it, forget_loss=0.9155, retain_loss=0.5706, total_loss=3.7688]DSU Epoch 2/3:  68%|██████▊   | 27/40 [00:33<00:16,  1.25s/it, forget_loss=0.9155, retain_loss=0.5706, total_loss=3.7688]DSU Epoch 2/3:  70%|███████   | 28/40 [00:35<00:15,  1.26s/it, forget_loss=0.9155, retain_loss=0.5706, total_loss=3.7688]DSU Epoch 2/3:  72%|███████▎  | 29/40 [00:36<00:13,  1.26s/it, forget_loss=0.9155, retain_loss=0.5706, total_loss=3.7688]DSU Epoch 2/3:  72%|███████▎  | 29/40 [00:37<00:13,  1.26s/it, forget_loss=0.8393, retain_loss=0.5445, total_loss=3.5617]DSU Epoch 2/3:  75%|███████▌  | 30/40 [00:37<00:12,  1.26s/it, forget_loss=0.8393, retain_loss=0.5445, total_loss=3.5617]DSU Epoch 2/3:  78%|███████▊  | 31/40 [00:38<00:11,  1.25s/it, forget_loss=0.8393, retain_loss=0.5445, total_loss=3.5617]DSU Epoch 2/3:  80%|████████  | 32/40 [00:40<00:10,  1.26s/it, forget_loss=0.8393, retain_loss=0.5445, total_loss=3.5617]DSU Epoch 2/3:  82%|████████▎ | 33/40 [00:41<00:08,  1.26s/it, forget_loss=0.8393, retain_loss=0.5445, total_loss=3.5617]DSU Epoch 2/3:  85%|████████▌ | 34/40 [00:42<00:07,  1.26s/it, forget_loss=0.8393, retain_loss=0.5445, total_loss=3.5617]DSU Epoch 2/3:  88%|████████▊ | 35/40 [00:43<00:06,  1.25s/it, forget_loss=0.8393, retain_loss=0.5445, total_loss=3.5617]DSU Epoch 2/3:  90%|█████████ | 36/40 [00:45<00:05,  1.26s/it, forget_loss=0.8393, retain_loss=0.5445, total_loss=3.5617]DSU Epoch 2/3:  92%|█████████▎| 37/40 [00:46<00:03,  1.26s/it, forget_loss=0.8393, retain_loss=0.5445, total_loss=3.5617]DSU Epoch 2/3:  95%|█████████▌| 38/40 [00:47<00:02,  1.25s/it, forget_loss=0.8393, retain_loss=0.5445, total_loss=3.5617]DSU Epoch 2/3:  98%|█████████▊| 39/40 [00:48<00:01,  1.25s/it, forget_loss=0.8393, retain_loss=0.5445, total_loss=3.5617]DSU Epoch 2/3:  98%|█████████▊| 39/40 [00:50<00:01,  1.25s/it, forget_loss=0.9200, retain_loss=0.3282, total_loss=2.5610]DSU Epoch 2/3: 100%|██████████| 40/40 [00:50<00:00,  1.26s/it, forget_loss=0.9200, retain_loss=0.3282, total_loss=2.5610]DSU Epoch 2/3: 100%|██████████| 40/40 [00:50<00:00,  1.26s/it, forget_loss=0.9200, retain_loss=0.3282, total_loss=2.5610]
DSU Epoch 3/3:   0%|          | 0/40 [00:00<?, ?it/s]DSU Epoch 3/3:   2%|▎         | 1/40 [00:01<00:48,  1.25s/it]DSU Epoch 3/3:   5%|▌         | 2/40 [00:02<00:47,  1.25s/it]DSU Epoch 3/3:   8%|▊         | 3/40 [00:03<00:46,  1.25s/it]DSU Epoch 3/3:  10%|█         | 4/40 [00:05<00:45,  1.25s/it]DSU Epoch 3/3:  12%|█▎        | 5/40 [00:06<00:43,  1.25s/it]DSU Epoch 3/3:  15%|█▌        | 6/40 [00:07<00:42,  1.25s/it]DSU Epoch 3/3:  18%|█▊        | 7/40 [00:08<00:41,  1.26s/it]DSU Epoch 3/3:  20%|██        | 8/40 [00:10<00:40,  1.26s/it]DSU Epoch 3/3:  22%|██▎       | 9/40 [00:11<00:38,  1.25s/it]DSU Epoch 3/3:  22%|██▎       | 9/40 [00:12<00:38,  1.25s/it, forget_loss=0.9199, retain_loss=0.2392, total_loss=2.1162]DSU Epoch 3/3:  25%|██▌       | 10/40 [00:12<00:37,  1.25s/it, forget_loss=0.9199, retain_loss=0.2392, total_loss=2.1162]DSU Epoch 3/3:  28%|██▊       | 11/40 [00:13<00:36,  1.25s/it, forget_loss=0.9199, retain_loss=0.2392, total_loss=2.1162]DSU Epoch 3/3:  30%|███       | 12/40 [00:15<00:35,  1.25s/it, forget_loss=0.9199, retain_loss=0.2392, total_loss=2.1162]DSU Epoch 3/3:  32%|███▎      | 13/40 [00:16<00:33,  1.25s/it, forget_loss=0.9199, retain_loss=0.2392, total_loss=2.1162]DSU Epoch 3/3:  35%|███▌      | 14/40 [00:17<00:32,  1.25s/it, forget_loss=0.9199, retain_loss=0.2392, total_loss=2.1162]DSU Epoch 3/3:  38%|███▊      | 15/40 [00:18<00:31,  1.25s/it, forget_loss=0.9199, retain_loss=0.2392, total_loss=2.1162]DSU Epoch 3/3:  40%|████      | 16/40 [00:20<00:30,  1.26s/it, forget_loss=0.9199, retain_loss=0.2392, total_loss=2.1162]DSU Epoch 3/3:  42%|████▎     | 17/40 [00:21<00:28,  1.26s/it, forget_loss=0.9199, retain_loss=0.2392, total_loss=2.1162]DSU Epoch 3/3:  45%|████▌     | 18/40 [00:22<00:27,  1.25s/it, forget_loss=0.9199, retain_loss=0.2392, total_loss=2.1162]DSU Epoch 3/3:  48%|████▊     | 19/40 [00:23<00:26,  1.25s/it, forget_loss=0.9199, retain_loss=0.2392, total_loss=2.1162]DSU Epoch 3/3:  48%|████▊     | 19/40 [00:25<00:26,  1.25s/it, forget_loss=0.8298, retain_loss=0.3222, total_loss=2.4408]DSU Epoch 3/3:  48%|████▊     | 19/40 [00:25<00:27,  1.32s/it, forget_loss=0.8298, retain_loss=0.3222, total_loss=2.4408]
  Evaluating Dual Signed Adaptation (DSU)...
Running full evaluation...
  Computing forget efficacy...
Computing perplexity:   0%|          | 0/40 [00:00<?, ?it/s]Computing perplexity:   2%|▎         | 1/40 [00:00<00:07,  5.43it/s]Computing perplexity:   5%|▌         | 2/40 [00:00<00:07,  5.34it/s]Computing perplexity:   8%|▊         | 3/40 [00:00<00:07,  5.28it/s]Computing perplexity:  10%|█         | 4/40 [00:00<00:06,  5.30it/s]Computing perplexity:  12%|█▎        | 5/40 [00:00<00:06,  5.28it/s]Computing perplexity:  15%|█▌        | 6/40 [00:01<00:06,  5.29it/s]Computing perplexity:  18%|█▊        | 7/40 [00:01<00:06,  5.27it/s]Computing perplexity:  20%|██        | 8/40 [00:01<00:06,  5.28it/s]Computing perplexity:  22%|██▎       | 9/40 [00:01<00:05,  5.27it/s]Computing perplexity:  25%|██▌       | 10/40 [00:01<00:05,  5.27it/s]Computing perplexity:  28%|██▊       | 11/40 [00:02<00:05,  5.27it/s]Computing perplexity:  30%|███       | 12/40 [00:02<00:05,  5.27it/s]Computing perplexity:  32%|███▎      | 13/40 [00:02<00:05,  5.26it/s]Computing perplexity:  35%|███▌      | 14/40 [00:02<00:04,  5.27it/s]Computing perplexity:  38%|███▊      | 15/40 [00:02<00:04,  5.27it/s]Computing perplexity:  40%|████      | 16/40 [00:03<00:04,  5.27it/s]Computing perplexity:  42%|████▎     | 17/40 [00:03<00:04,  5.27it/s]Computing perplexity:  45%|████▌     | 18/40 [00:03<00:04,  5.27it/s]Computing perplexity:  48%|████▊     | 19/40 [00:03<00:03,  5.27it/s]Computing perplexity:  50%|█████     | 20/40 [00:03<00:03,  5.27it/s]Computing perplexity:  52%|█████▎    | 21/40 [00:03<00:03,  5.27it/s]Computing perplexity:  55%|█████▌    | 22/40 [00:04<00:03,  5.27it/s]Computing perplexity:  57%|█████▊    | 23/40 [00:04<00:03,  5.27it/s]Computing perplexity:  60%|██████    | 24/40 [00:04<00:03,  5.27it/s]Computing perplexity:  62%|██████▎   | 25/40 [00:04<00:02,  5.23it/s]Computing perplexity:  65%|██████▌   | 26/40 [00:04<00:02,  5.25it/s]Computing perplexity:  68%|██████▊   | 27/40 [00:05<00:02,  5.23it/s]Computing perplexity:  70%|███████   | 28/40 [00:05<00:02,  5.25it/s]Computing perplexity:  72%|███████▎  | 29/40 [00:05<00:02,  5.24it/s]Computing perplexity:  75%|███████▌  | 30/40 [00:05<00:01,  5.26it/s]Computing perplexity:  78%|███████▊  | 31/40 [00:05<00:01,  5.25it/s]Computing perplexity:  80%|████████  | 32/40 [00:06<00:01,  5.25it/s]Computing perplexity:  82%|████████▎ | 33/40 [00:06<00:01,  5.25it/s]Computing perplexity:  85%|████████▌ | 34/40 [00:06<00:01,  5.27it/s]Computing perplexity:  88%|████████▊ | 35/40 [00:06<00:00,  5.25it/s]Computing perplexity:  90%|█████████ | 36/40 [00:06<00:00,  5.27it/s]Computing perplexity:  92%|█████████▎| 37/40 [00:07<00:00,  5.26it/s]Computing perplexity:  95%|█████████▌| 38/40 [00:07<00:00,  5.27it/s]Computing perplexity:  98%|█████████▊| 39/40 [00:07<00:00,  5.26it/s]Computing perplexity: 100%|██████████| 40/40 [00:07<00:00,  5.28it/s]                                                                       Computing retain performance...
Computing perplexity:   0%|          | 0/3960 [00:00<?, ?it/s]Computing perplexity:   0%|          | 1/3960 [00:00<12:38,  5.22it/s]Computing perplexity:   0%|          | 2/3960 [00:00<12:34,  5.25it/s]Computing perplexity:   0%|          | 3/3960 [00:00<12:32,  5.26it/s]Computing perplexity:   0%|          | 4/3960 [00:00<12:32,  5.26it/s]Computing perplexity:   0%|          | 5/3960 [00:00<12:31,  5.27it/s]Computing perplexity:   0%|          | 6/3960 [00:01<12:30,  5.27it/s]Computing perplexity:   0%|          | 7/3960 [00:01<12:30,  5.27it/s]Computing perplexity:   0%|          | 8/3960 [00:01<12:29,  5.27it/s]Computing perplexity:   0%|          | 9/3960 [00:01<12:29,  5.27it/s]Computing perplexity:   0%|          | 10/3960 [00:01<12:28,  5.28it/s]Computing perplexity:   0%|          | 11/3960 [00:02<12:30,  5.26it/s]Computing perplexity:   0%|          | 12/3960 [00:02<12:28,  5.27it/s]Computing perplexity:   0%|          | 13/3960 [00:02<12:29,  5.27it/s]Computing perplexity:   0%|          | 14/3960 [00:02<12:29,  5.27it/s]Computing perplexity:   0%|          | 15/3960 [00:02<12:29,  5.26it/s]Computing perplexity:   0%|          | 16/3960 [00:03<12:27,  5.28it/s]Computing perplexity:   0%|          | 17/3960 [00:03<12:28,  5.27it/s]Computing perplexity:   0%|          | 18/3960 [00:03<12:26,  5.28it/s]Computing perplexity:   0%|          | 19/3960 [00:03<12:27,  5.27it/s]Computing perplexity:   1%|          | 20/3960 [00:03<12:26,  5.28it/s]Computing perplexity:   1%|          | 21/3960 [00:03<12:27,  5.27it/s]Computing perplexity:   1%|          | 22/3960 [00:04<12:26,  5.28it/s]Computing perplexity:   1%|          | 23/3960 [00:04<12:28,  5.26it/s]Computing perplexity:   1%|          | 24/3960 [00:04<12:26,  5.27it/s]Computing perplexity:   1%|          | 25/3960 [00:04<12:28,  5.26it/s]Computing perplexity:   1%|          | 26/3960 [00:04<12:26,  5.27it/s]Computing perplexity:   1%|          | 27/3960 [00:05<12:28,  5.26it/s]Computing perplexity:   1%|          | 28/3960 [00:05<12:25,  5.28it/s]Computing perplexity:   1%|          | 29/3960 [00:05<12:27,  5.26it/s]Computing perplexity:   1%|          | 30/3960 [00:05<12:25,  5.27it/s]Computing perplexity:   1%|          | 31/3960 [00:05<12:26,  5.26it/s]Computing perplexity:   1%|          | 32/3960 [00:06<12:24,  5.28it/s]Computing perplexity:   1%|          | 33/3960 [00:06<12:26,  5.26it/s]Computing perplexity:   1%|          | 34/3960 [00:06<12:24,  5.28it/s]Computing perplexity:   1%|          | 35/3960 [00:06<12:26,  5.26it/s]Computing perplexity:   1%|          | 36/3960 [00:06<12:24,  5.27it/s]Computing perplexity:   1%|          | 37/3960 [00:07<12:25,  5.26it/s]Computing perplexity:   1%|          | 38/3960 [00:07<12:24,  5.27it/s]Computing perplexity:   1%|          | 39/3960 [00:07<12:28,  5.24it/s]Computing perplexity:   1%|          | 40/3960 [00:07<12:27,  5.25it/s]Computing perplexity:   1%|          | 41/3960 [00:07<12:26,  5.25it/s]Computing perplexity:   1%|          | 42/3960 [00:07<12:25,  5.26it/s]Computing perplexity:   1%|          | 43/3960 [00:08<12:25,  5.26it/s]Computing perplexity:   1%|          | 44/3960 [00:08<12:23,  5.27it/s]Computing perplexity:   1%|          | 45/3960 [00:08<12:25,  5.25it/s]Computing perplexity:   1%|          | 46/3960 [00:08<12:22,  5.27it/s]Computing perplexity:   1%|          | 47/3960 [00:08<12:24,  5.25it/s]Computing perplexity:   1%|          | 48/3960 [00:09<12:23,  5.26it/s]Computing perplexity:   1%|          | 49/3960 [00:09<12:23,  5.26it/s]Computing perplexity:   1%|▏         | 50/3960 [00:09<12:22,  5.27it/s]Computing perplexity:   1%|▏         | 51/3960 [00:09<12:22,  5.27it/s]Computing perplexity:   1%|▏         | 52/3960 [00:09<12:21,  5.27it/s]Computing perplexity:   1%|▏         | 53/3960 [00:10<12:22,  5.27it/s]Computing perplexity:   1%|▏         | 54/3960 [00:10<12:21,  5.26it/s]Computing perplexity:   1%|▏         | 55/3960 [00:10<12:22,  5.26it/s]Computing perplexity:   1%|▏         | 56/3960 [00:10<12:21,  5.27it/s]Computing perplexity:   1%|▏         | 57/3960 [00:10<12:21,  5.27it/s]Computing perplexity:   1%|▏         | 58/3960 [00:11<12:19,  5.27it/s]Computing perplexity:   1%|▏         | 59/3960 [00:11<12:19,  5.27it/s]Computing perplexity:   2%|▏         | 60/3960 [00:11<12:17,  5.29it/s]Computing perplexity:   2%|▏         | 61/3960 [00:11<12:20,  5.27it/s]Computing perplexity:   2%|▏         | 62/3960 [00:11<12:18,  5.28it/s]Computing perplexity:   2%|▏         | 63/3960 [00:11<12:20,  5.26it/s]Computing perplexity:   2%|▏         | 64/3960 [00:12<12:18,  5.28it/s]Computing perplexity:   2%|▏         | 65/3960 [00:12<12:19,  5.26it/s]Computing perplexity:   2%|▏         | 66/3960 [00:12<12:17,  5.28it/s]Computing perplexity:   2%|▏         | 67/3960 [00:12<12:20,  5.26it/s]Computing perplexity:   2%|▏         | 68/3960 [00:12<12:18,  5.27it/s]Computing perplexity:   2%|▏         | 69/3960 [00:13<12:19,  5.26it/s]Computing perplexity:   2%|▏         | 70/3960 [00:13<12:17,  5.27it/s]Computing perplexity:   2%|▏         | 71/3960 [00:13<12:19,  5.26it/s]Computing perplexity:   2%|▏         | 72/3960 [00:13<12:17,  5.27it/s]Computing perplexity:   2%|▏         | 73/3960 [00:13<12:18,  5.26it/s]Computing perplexity:   2%|▏         | 74/3960 [00:14<12:17,  5.27it/s]Computing perplexity:   2%|▏         | 75/3960 [00:14<12:18,  5.26it/s]Computing perplexity:   2%|▏         | 76/3960 [00:14<12:16,  5.27it/s]Computing perplexity:   2%|▏         | 77/3960 [00:14<12:18,  5.25it/s]Computing perplexity:   2%|▏         | 78/3960 [00:14<12:16,  5.27it/s]Computing perplexity:   2%|▏         | 79/3960 [00:15<12:18,  5.26it/s]Computing perplexity:   2%|▏         | 80/3960 [00:15<12:17,  5.26it/s]Computing perplexity:   2%|▏         | 81/3960 [00:15<12:18,  5.26it/s]Computing perplexity:   2%|▏         | 82/3960 [00:15<12:15,  5.27it/s]Computing perplexity:   2%|▏         | 83/3960 [00:15<12:17,  5.26it/s]Computing perplexity:   2%|▏         | 84/3960 [00:15<12:15,  5.27it/s]Computing perplexity:   2%|▏         | 85/3960 [00:16<12:16,  5.26it/s]Computing perplexity:   2%|▏         | 86/3960 [00:16<12:16,  5.26it/s]Computing perplexity:   2%|▏         | 87/3960 [00:16<12:17,  5.25it/s]Computing perplexity:   2%|▏         | 88/3960 [00:16<12:14,  5.27it/s]Computing perplexity:   2%|▏         | 89/3960 [00:16<12:15,  5.26it/s]Computing perplexity:   2%|▏         | 90/3960 [00:17<12:13,  5.28it/s]Computing perplexity:   2%|▏         | 91/3960 [00:17<12:15,  5.26it/s]Computing perplexity:   2%|▏         | 92/3960 [00:17<12:13,  5.28it/s]Computing perplexity:   2%|▏         | 93/3960 [00:17<12:15,  5.26it/s]Computing perplexity:   2%|▏         | 94/3960 [00:17<12:12,  5.28it/s]Computing perplexity:   2%|▏         | 95/3960 [00:18<12:14,  5.26it/s]Computing perplexity:   2%|▏         | 96/3960 [00:18<12:12,  5.28it/s]Computing perplexity:   2%|▏         | 97/3960 [00:18<12:14,  5.26it/s]Computing perplexity:   2%|▏         | 98/3960 [00:18<12:13,  5.27it/s]Computing perplexity:   2%|▎         | 99/3960 [00:18<12:15,  5.25it/s]                                                                         Computing MIA resistance...
    Forget Efficacy: 0.00%
    Retain Performance: 100.00%
    MIA Resistance: 65.71%

============================================================
Method: Trust-Region Orthogonal Unlearning (TROU)
============================================================
  Resetting model to fresh state...
Loading model: Qwen/Qwen3-4B-Instruct-2507
Quantization: True, LoRA: True
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:01<00:02,  1.10s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:02<00:01,  1.18s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:02<00:00,  1.26it/s]
trainable params: 11,796,480 || all params: 4,034,264,576 || trainable%: 0.2924
TROU Epoch 1/3:   0%|          | 0/40 [00:00<?, ?it/s]TROU Epoch 1/3:   2%|▎         | 1/40 [00:01<00:50,  1.29s/it]TROU Epoch 1/3:   5%|▌         | 2/40 [00:02<00:48,  1.29s/it]TROU Epoch 1/3:   8%|▊         | 3/40 [00:03<00:47,  1.29s/it]TROU Epoch 1/3:  10%|█         | 4/40 [00:05<00:46,  1.29s/it]TROU Epoch 1/3:  12%|█▎        | 5/40 [00:06<00:45,  1.29s/it]TROU Epoch 1/3:  15%|█▌        | 6/40 [00:07<00:43,  1.29s/it]TROU Epoch 1/3:  18%|█▊        | 7/40 [00:09<00:42,  1.29s/it]TROU Epoch 1/3:  20%|██        | 8/40 [00:10<00:41,  1.29s/it]TROU Epoch 1/3:  22%|██▎       | 9/40 [00:11<00:39,  1.29s/it]TROU Epoch 1/3:  22%|██▎       | 9/40 [00:12<00:39,  1.29s/it, retain_loss=21.3053, forget_loss=19.0168, projection_ratio=0.9552]TROU Epoch 1/3:  25%|██▌       | 10/40 [00:12<00:38,  1.29s/it, retain_loss=21.3053, forget_loss=19.0168, projection_ratio=0.9552]TROU Epoch 1/3:  28%|██▊       | 11/40 [00:14<00:37,  1.29s/it, retain_loss=21.3053, forget_loss=19.0168, projection_ratio=0.9552]TROU Epoch 1/3:  30%|███       | 12/40 [00:15<00:36,  1.29s/it, retain_loss=21.3053, forget_loss=19.0168, projection_ratio=0.9552]TROU Epoch 1/3:  32%|███▎      | 13/40 [00:16<00:34,  1.29s/it, retain_loss=21.3053, forget_loss=19.0168, projection_ratio=0.9552]TROU Epoch 1/3:  35%|███▌      | 14/40 [00:18<00:33,  1.29s/it, retain_loss=21.3053, forget_loss=19.0168, projection_ratio=0.9552]TROU Epoch 1/3:  38%|███▊      | 15/40 [00:19<00:32,  1.29s/it, retain_loss=21.3053, forget_loss=19.0168, projection_ratio=0.9552]TROU Epoch 1/3:  40%|████      | 16/40 [00:20<00:30,  1.29s/it, retain_loss=21.3053, forget_loss=19.0168, projection_ratio=0.9552]TROU Epoch 1/3:  42%|████▎     | 17/40 [00:21<00:29,  1.29s/it, retain_loss=21.3053, forget_loss=19.0168, projection_ratio=0.9552]TROU Epoch 1/3:  45%|████▌     | 18/40 [00:23<00:28,  1.29s/it, retain_loss=21.3053, forget_loss=19.0168, projection_ratio=0.9552]TROU Epoch 1/3:  48%|████▊     | 19/40 [00:24<00:27,  1.29s/it, retain_loss=21.3053, forget_loss=19.0168, projection_ratio=0.9552]TROU Epoch 1/3:  48%|████▊     | 19/40 [00:25<00:27,  1.29s/it, retain_loss=29.0298, forget_loss=26.3584, projection_ratio=0.8436]TROU Epoch 1/3:  50%|█████     | 20/40 [00:25<00:25,  1.29s/it, retain_loss=29.0298, forget_loss=26.3584, projection_ratio=0.8436]TROU Epoch 1/3:  52%|█████▎    | 21/40 [00:27<00:24,  1.30s/it, retain_loss=29.0298, forget_loss=26.3584, projection_ratio=0.8436]TROU Epoch 1/3:  55%|█████▌    | 22/40 [00:28<00:23,  1.29s/it, retain_loss=29.0298, forget_loss=26.3584, projection_ratio=0.8436]TROU Epoch 1/3:  57%|█████▊    | 23/40 [00:29<00:21,  1.29s/it, retain_loss=29.0298, forget_loss=26.3584, projection_ratio=0.8436]TROU Epoch 1/3:  60%|██████    | 24/40 [00:30<00:20,  1.29s/it, retain_loss=29.0298, forget_loss=26.3584, projection_ratio=0.8436]TROU Epoch 1/3:  62%|██████▎   | 25/40 [00:32<00:19,  1.29s/it, retain_loss=29.0298, forget_loss=26.3584, projection_ratio=0.8436]TROU Epoch 1/3:  65%|██████▌   | 26/40 [00:33<00:18,  1.29s/it, retain_loss=29.0298, forget_loss=26.3584, projection_ratio=0.8436]TROU Epoch 1/3:  68%|██████▊   | 27/40 [00:34<00:16,  1.29s/it, retain_loss=29.0298, forget_loss=26.3584, projection_ratio=0.8436]TROU Epoch 1/3:  70%|███████   | 28/40 [00:36<00:15,  1.29s/it, retain_loss=29.0298, forget_loss=26.3584, projection_ratio=0.8436]TROU Epoch 1/3:  72%|███████▎  | 29/40 [00:37<00:14,  1.29s/it, retain_loss=29.0298, forget_loss=26.3584, projection_ratio=0.8436]TROU Epoch 1/3:  72%|███████▎  | 29/40 [00:38<00:14,  1.29s/it, retain_loss=25.5797, forget_loss=26.4556, projection_ratio=0.8856]TROU Epoch 1/3:  75%|███████▌  | 30/40 [00:38<00:12,  1.29s/it, retain_loss=25.5797, forget_loss=26.4556, projection_ratio=0.8856]TROU Epoch 1/3:  78%|███████▊  | 31/40 [00:39<00:11,  1.29s/it, retain_loss=25.5797, forget_loss=26.4556, projection_ratio=0.8856]TROU Epoch 1/3:  80%|████████  | 32/40 [00:41<00:10,  1.29s/it, retain_loss=25.5797, forget_loss=26.4556, projection_ratio=0.8856]TROU Epoch 1/3:  82%|████████▎ | 33/40 [00:42<00:09,  1.29s/it, retain_loss=25.5797, forget_loss=26.4556, projection_ratio=0.8856]TROU Epoch 1/3:  85%|████████▌ | 34/40 [00:43<00:07,  1.29s/it, retain_loss=25.5797, forget_loss=26.4556, projection_ratio=0.8856]TROU Epoch 1/3:  88%|████████▊ | 35/40 [00:45<00:06,  1.29s/it, retain_loss=25.5797, forget_loss=26.4556, projection_ratio=0.8856]TROU Epoch 1/3:  90%|█████████ | 36/40 [00:46<00:05,  1.29s/it, retain_loss=25.5797, forget_loss=26.4556, projection_ratio=0.8856]TROU Epoch 1/3:  92%|█████████▎| 37/40 [00:47<00:03,  1.29s/it, retain_loss=25.5797, forget_loss=26.4556, projection_ratio=0.8856]TROU Epoch 1/3:  95%|█████████▌| 38/40 [00:49<00:02,  1.29s/it, retain_loss=25.5797, forget_loss=26.4556, projection_ratio=0.8856]TROU Epoch 1/3:  98%|█████████▊| 39/40 [00:50<00:01,  1.29s/it, retain_loss=25.5797, forget_loss=26.4556, projection_ratio=0.8856]TROU Epoch 1/3:  98%|█████████▊| 39/40 [00:51<00:01,  1.29s/it, retain_loss=29.1647, forget_loss=28.9172, projection_ratio=0.7353]TROU Epoch 1/3: 100%|██████████| 40/40 [00:51<00:00,  1.29s/it, retain_loss=29.1647, forget_loss=28.9172, projection_ratio=0.7353]TROU Epoch 1/3: 100%|██████████| 40/40 [00:51<00:00,  1.29s/it, retain_loss=29.1647, forget_loss=28.9172, projection_ratio=0.7353]
TROU Epoch 2/3:   0%|          | 0/40 [00:00<?, ?it/s]TROU Epoch 2/3:   2%|▎         | 1/40 [00:01<00:50,  1.29s/it]TROU Epoch 2/3:   5%|▌         | 2/40 [00:02<00:49,  1.29s/it]TROU Epoch 2/3:   8%|▊         | 3/40 [00:03<00:47,  1.29s/it]TROU Epoch 2/3:  10%|█         | 4/40 [00:05<00:46,  1.29s/it]TROU Epoch 2/3:  12%|█▎        | 5/40 [00:06<00:45,  1.29s/it]TROU Epoch 2/3:  15%|█▌        | 6/40 [00:07<00:43,  1.29s/it]TROU Epoch 2/3:  18%|█▊        | 7/40 [00:09<00:42,  1.29s/it]TROU Epoch 2/3:  20%|██        | 8/40 [00:10<00:41,  1.29s/it]TROU Epoch 2/3:  22%|██▎       | 9/40 [00:11<00:40,  1.29s/it]TROU Epoch 2/3:  22%|██▎       | 9/40 [00:12<00:40,  1.29s/it, retain_loss=28.5671, forget_loss=36.6433, projection_ratio=0.7809]TROU Epoch 2/3:  25%|██▌       | 10/40 [00:12<00:38,  1.29s/it, retain_loss=28.5671, forget_loss=36.6433, projection_ratio=0.7809]TROU Epoch 2/3:  28%|██▊       | 11/40 [00:14<00:37,  1.29s/it, retain_loss=28.5671, forget_loss=36.6433, projection_ratio=0.7809]TROU Epoch 2/3:  30%|███       | 12/40 [00:15<00:36,  1.29s/it, retain_loss=28.5671, forget_loss=36.6433, projection_ratio=0.7809]TROU Epoch 2/3:  32%|███▎      | 13/40 [00:16<00:34,  1.29s/it, retain_loss=28.5671, forget_loss=36.6433, projection_ratio=0.7809]TROU Epoch 2/3:  35%|███▌      | 14/40 [00:18<00:33,  1.29s/it, retain_loss=28.5671, forget_loss=36.6433, projection_ratio=0.7809]TROU Epoch 2/3:  38%|███▊      | 15/40 [00:19<00:32,  1.29s/it, retain_loss=28.5671, forget_loss=36.6433, projection_ratio=0.7809]TROU Epoch 2/3:  40%|████      | 16/40 [00:20<00:30,  1.29s/it, retain_loss=28.5671, forget_loss=36.6433, projection_ratio=0.7809]TROU Epoch 2/3:  42%|████▎     | 17/40 [00:21<00:29,  1.29s/it, retain_loss=28.5671, forget_loss=36.6433, projection_ratio=0.7809]TROU Epoch 2/3:  45%|████▌     | 18/40 [00:23<00:28,  1.29s/it, retain_loss=28.5671, forget_loss=36.6433, projection_ratio=0.7809]TROU Epoch 2/3:  48%|████▊     | 19/40 [00:24<00:27,  1.29s/it, retain_loss=28.5671, forget_loss=36.6433, projection_ratio=0.7809]TROU Epoch 2/3:  48%|████▊     | 19/40 [00:25<00:27,  1.29s/it, retain_loss=36.0098, forget_loss=39.3003, projection_ratio=0.8262]TROU Epoch 2/3:  50%|█████     | 20/40 [00:25<00:25,  1.29s/it, retain_loss=36.0098, forget_loss=39.3003, projection_ratio=0.8262]TROU Epoch 2/3:  52%|█████▎    | 21/40 [00:27<00:24,  1.29s/it, retain_loss=36.0098, forget_loss=39.3003, projection_ratio=0.8262]TROU Epoch 2/3:  55%|█████▌    | 22/40 [00:28<00:23,  1.29s/it, retain_loss=36.0098, forget_loss=39.3003, projection_ratio=0.8262]TROU Epoch 2/3:  57%|█████▊    | 23/40 [00:29<00:21,  1.29s/it, retain_loss=36.0098, forget_loss=39.3003, projection_ratio=0.8262]TROU Epoch 2/3:  60%|██████    | 24/40 [00:30<00:20,  1.29s/it, retain_loss=36.0098, forget_loss=39.3003, projection_ratio=0.8262]TROU Epoch 2/3:  62%|██████▎   | 25/40 [00:32<00:19,  1.29s/it, retain_loss=36.0098, forget_loss=39.3003, projection_ratio=0.8262]TROU Epoch 2/3:  65%|██████▌   | 26/40 [00:33<00:18,  1.29s/it, retain_loss=36.0098, forget_loss=39.3003, projection_ratio=0.8262]TROU Epoch 2/3:  68%|██████▊   | 27/40 [00:34<00:16,  1.29s/it, retain_loss=36.0098, forget_loss=39.3003, projection_ratio=0.8262]TROU Epoch 2/3:  70%|███████   | 28/40 [00:36<00:15,  1.29s/it, retain_loss=36.0098, forget_loss=39.3003, projection_ratio=0.8262]TROU Epoch 2/3:  72%|███████▎  | 29/40 [00:37<00:14,  1.29s/it, retain_loss=36.0098, forget_loss=39.3003, projection_ratio=0.8262]TROU Epoch 2/3:  72%|███████▎  | 29/40 [00:38<00:14,  1.29s/it, retain_loss=47.3282, forget_loss=46.1223, projection_ratio=0.8079]TROU Epoch 2/3:  75%|███████▌  | 30/40 [00:38<00:12,  1.29s/it, retain_loss=47.3282, forget_loss=46.1223, projection_ratio=0.8079]TROU Epoch 2/3:  78%|███████▊  | 31/40 [00:39<00:11,  1.29s/it, retain_loss=47.3282, forget_loss=46.1223, projection_ratio=0.8079]TROU Epoch 2/3:  80%|████████  | 32/40 [00:41<00:10,  1.29s/it, retain_loss=47.3282, forget_loss=46.1223, projection_ratio=0.8079]TROU Epoch 2/3:  82%|████████▎ | 33/40 [00:42<00:09,  1.29s/it, retain_loss=47.3282, forget_loss=46.1223, projection_ratio=0.8079]TROU Epoch 2/3:  85%|████████▌ | 34/40 [00:43<00:07,  1.29s/it, retain_loss=47.3282, forget_loss=46.1223, projection_ratio=0.8079]TROU Epoch 2/3:  88%|████████▊ | 35/40 [00:45<00:06,  1.29s/it, retain_loss=47.3282, forget_loss=46.1223, projection_ratio=0.8079]TROU Epoch 2/3:  90%|█████████ | 36/40 [00:46<00:05,  1.29s/it, retain_loss=47.3282, forget_loss=46.1223, projection_ratio=0.8079]TROU Epoch 2/3:  92%|█████████▎| 37/40 [00:47<00:03,  1.29s/it, retain_loss=47.3282, forget_loss=46.1223, projection_ratio=0.8079]TROU Epoch 2/3:  95%|█████████▌| 38/40 [00:49<00:02,  1.29s/it, retain_loss=47.3282, forget_loss=46.1223, projection_ratio=0.8079]TROU Epoch 2/3:  98%|█████████▊| 39/40 [00:50<00:01,  1.29s/it, retain_loss=47.3282, forget_loss=46.1223, projection_ratio=0.8079]TROU Epoch 2/3:  98%|█████████▊| 39/40 [00:51<00:01,  1.29s/it, retain_loss=47.9379, forget_loss=55.0198, projection_ratio=0.8560]TROU Epoch 2/3: 100%|██████████| 40/40 [00:51<00:00,  1.29s/it, retain_loss=47.9379, forget_loss=55.0198, projection_ratio=0.8560]TROU Epoch 2/3: 100%|██████████| 40/40 [00:51<00:00,  1.29s/it, retain_loss=47.9379, forget_loss=55.0198, projection_ratio=0.8560]
TROU Epoch 3/3:   0%|          | 0/40 [00:00<?, ?it/s]TROU Epoch 3/3:   2%|▎         | 1/40 [00:01<00:50,  1.29s/it]TROU Epoch 3/3:   5%|▌         | 2/40 [00:02<00:49,  1.29s/it]TROU Epoch 3/3:   8%|▊         | 3/40 [00:03<00:47,  1.29s/it]TROU Epoch 3/3:  10%|█         | 4/40 [00:05<00:46,  1.29s/it]TROU Epoch 3/3:  12%|█▎        | 5/40 [00:06<00:45,  1.29s/it]TROU Epoch 3/3:  15%|█▌        | 6/40 [00:07<00:43,  1.29s/it]TROU Epoch 3/3:  18%|█▊        | 7/40 [00:09<00:42,  1.29s/it]TROU Epoch 3/3:  20%|██        | 8/40 [00:10<00:41,  1.29s/it]TROU Epoch 3/3:  22%|██▎       | 9/40 [00:11<00:40,  1.29s/it]TROU Epoch 3/3:  22%|██▎       | 9/40 [00:12<00:40,  1.29s/it, retain_loss=63.7256, forget_loss=65.2220, projection_ratio=0.7414]TROU Epoch 3/3:  25%|██▌       | 10/40 [00:12<00:38,  1.29s/it, retain_loss=63.7256, forget_loss=65.2220, projection_ratio=0.7414]TROU Epoch 3/3:  28%|██▊       | 11/40 [00:14<00:37,  1.29s/it, retain_loss=63.7256, forget_loss=65.2220, projection_ratio=0.7414]TROU Epoch 3/3:  30%|███       | 12/40 [00:15<00:36,  1.29s/it, retain_loss=63.7256, forget_loss=65.2220, projection_ratio=0.7414]TROU Epoch 3/3:  32%|███▎      | 13/40 [00:16<00:34,  1.29s/it, retain_loss=63.7256, forget_loss=65.2220, projection_ratio=0.7414]TROU Epoch 3/3:  35%|███▌      | 14/40 [00:18<00:33,  1.29s/it, retain_loss=63.7256, forget_loss=65.2220, projection_ratio=0.7414]TROU Epoch 3/3:  38%|███▊      | 15/40 [00:19<00:32,  1.29s/it, retain_loss=63.7256, forget_loss=65.2220, projection_ratio=0.7414]TROU Epoch 3/3:  40%|████      | 16/40 [00:20<00:30,  1.29s/it, retain_loss=63.7256, forget_loss=65.2220, projection_ratio=0.7414]TROU Epoch 3/3:  42%|████▎     | 17/40 [00:21<00:29,  1.29s/it, retain_loss=63.7256, forget_loss=65.2220, projection_ratio=0.7414]TROU Epoch 3/3:  45%|████▌     | 18/40 [00:23<00:28,  1.29s/it, retain_loss=63.7256, forget_loss=65.2220, projection_ratio=0.7414]TROU Epoch 3/3:  48%|████▊     | 19/40 [00:24<00:27,  1.29s/it, retain_loss=63.7256, forget_loss=65.2220, projection_ratio=0.7414]TROU Epoch 3/3:  48%|████▊     | 19/40 [00:25<00:27,  1.29s/it, retain_loss=81.1876, forget_loss=80.5909, projection_ratio=0.6954]TROU Epoch 3/3:  48%|████▊     | 19/40 [00:25<00:28,  1.36s/it, retain_loss=81.1876, forget_loss=80.5909, projection_ratio=0.6954]
  Evaluating Trust-Region Orthogonal (TROU)...
Running full evaluation...
  Computing forget efficacy...
Computing perplexity:   0%|          | 0/40 [00:00<?, ?it/s]Computing perplexity:   2%|▎         | 1/40 [00:00<00:07,  5.46it/s]Computing perplexity:   5%|▌         | 2/40 [00:00<00:07,  5.36it/s]Computing perplexity:   8%|▊         | 3/40 [00:00<00:06,  5.32it/s]Computing perplexity:  10%|█         | 4/40 [00:00<00:06,  5.30it/s]Computing perplexity:  12%|█▎        | 5/40 [00:00<00:06,  5.30it/s]Computing perplexity:  15%|█▌        | 6/40 [00:01<00:06,  5.28it/s]Computing perplexity:  18%|█▊        | 7/40 [00:01<00:06,  5.30it/s]Computing perplexity:  20%|██        | 8/40 [00:01<00:06,  5.28it/s]Computing perplexity:  22%|██▎       | 9/40 [00:01<00:05,  5.29it/s]Computing perplexity:  25%|██▌       | 10/40 [00:01<00:05,  5.27it/s]Computing perplexity:  28%|██▊       | 11/40 [00:02<00:05,  5.28it/s]Computing perplexity:  30%|███       | 12/40 [00:02<00:05,  5.27it/s]Computing perplexity:  32%|███▎      | 13/40 [00:02<00:05,  5.28it/s]Computing perplexity:  35%|███▌      | 14/40 [00:02<00:04,  5.26it/s]Computing perplexity:  38%|███▊      | 15/40 [00:02<00:04,  5.28it/s]Computing perplexity:  40%|████      | 16/40 [00:03<00:04,  5.25it/s]Computing perplexity:  42%|████▎     | 17/40 [00:03<00:04,  5.27it/s]Computing perplexity:  45%|████▌     | 18/40 [00:03<00:04,  5.26it/s]Computing perplexity:  48%|████▊     | 19/40 [00:03<00:03,  5.28it/s]Computing perplexity:  50%|█████     | 20/40 [00:03<00:03,  5.27it/s]Computing perplexity:  52%|█████▎    | 21/40 [00:03<00:03,  5.28it/s]Computing perplexity:  55%|█████▌    | 22/40 [00:04<00:03,  5.27it/s]Computing perplexity:  57%|█████▊    | 23/40 [00:04<00:03,  5.26it/s]Computing perplexity:  60%|██████    | 24/40 [00:04<00:03,  5.24it/s]Computing perplexity:  62%|██████▎   | 25/40 [00:04<00:02,  5.23it/s]Computing perplexity:  65%|██████▌   | 26/40 [00:04<00:02,  5.24it/s]Computing perplexity:  68%|██████▊   | 27/40 [00:05<00:02,  5.26it/s]Computing perplexity:  70%|███████   | 28/40 [00:05<00:02,  5.26it/s]Computing perplexity:  72%|███████▎  | 29/40 [00:05<00:02,  5.28it/s]Computing perplexity:  75%|███████▌  | 30/40 [00:05<00:01,  5.26it/s]Computing perplexity:  78%|███████▊  | 31/40 [00:05<00:01,  5.28it/s]Computing perplexity:  80%|████████  | 32/40 [00:06<00:01,  5.27it/s]Computing perplexity:  82%|████████▎ | 33/40 [00:06<00:01,  5.29it/s]Computing perplexity:  85%|████████▌ | 34/40 [00:06<00:01,  5.27it/s]Computing perplexity:  88%|████████▊ | 35/40 [00:06<00:00,  5.28it/s]Computing perplexity:  90%|█████████ | 36/40 [00:06<00:00,  5.26it/s]Computing perplexity:  92%|█████████▎| 37/40 [00:07<00:00,  5.29it/s]Computing perplexity:  95%|█████████▌| 38/40 [00:07<00:00,  5.28it/s]Computing perplexity:  98%|█████████▊| 39/40 [00:07<00:00,  5.29it/s]Computing perplexity: 100%|██████████| 40/40 [00:07<00:00,  5.28it/s]                                                                       Computing retain performance...
Computing perplexity:   0%|          | 0/3960 [00:00<?, ?it/s]Computing perplexity:   0%|          | 1/3960 [00:00<12:28,  5.29it/s]Computing perplexity:   0%|          | 2/3960 [00:00<12:34,  5.25it/s]Computing perplexity:   0%|          | 3/3960 [00:00<12:30,  5.27it/s]Computing perplexity:   0%|          | 4/3960 [00:00<12:34,  5.25it/s]Computing perplexity:   0%|          | 5/3960 [00:00<12:29,  5.27it/s]Computing perplexity:   0%|          | 6/3960 [00:01<12:31,  5.26it/s]Computing perplexity:   0%|          | 7/3960 [00:01<12:29,  5.28it/s]Computing perplexity:   0%|          | 8/3960 [00:01<12:32,  5.25it/s]Computing perplexity:   0%|          | 9/3960 [00:01<12:28,  5.28it/s]Computing perplexity:   0%|          | 10/3960 [00:01<12:31,  5.26it/s]Computing perplexity:   0%|          | 11/3960 [00:02<12:28,  5.27it/s]Computing perplexity:   0%|          | 12/3960 [00:02<12:30,  5.26it/s]Computing perplexity:   0%|          | 13/3960 [00:02<12:27,  5.28it/s]Computing perplexity:   0%|          | 14/3960 [00:02<12:29,  5.26it/s]Computing perplexity:   0%|          | 15/3960 [00:02<12:27,  5.28it/s]Computing perplexity:   0%|          | 16/3960 [00:03<12:28,  5.27it/s]Computing perplexity:   0%|          | 17/3960 [00:03<12:26,  5.28it/s]Computing perplexity:   0%|          | 18/3960 [00:03<12:28,  5.27it/s]Computing perplexity:   0%|          | 19/3960 [00:03<12:26,  5.28it/s]Computing perplexity:   1%|          | 20/3960 [00:03<12:28,  5.26it/s]Computing perplexity:   1%|          | 21/3960 [00:03<12:26,  5.28it/s]Computing perplexity:   1%|          | 22/3960 [00:04<12:26,  5.27it/s]Computing perplexity:   1%|          | 23/3960 [00:04<12:25,  5.28it/s]Computing perplexity:   1%|          | 24/3960 [00:04<12:25,  5.28it/s]Computing perplexity:   1%|          | 25/3960 [00:04<12:25,  5.28it/s]Computing perplexity:   1%|          | 26/3960 [00:04<12:24,  5.29it/s]Computing perplexity:   1%|          | 27/3960 [00:05<12:26,  5.27it/s]Computing perplexity:   1%|          | 28/3960 [00:05<12:25,  5.28it/s]Computing perplexity:   1%|          | 29/3960 [00:05<12:25,  5.27it/s]Computing perplexity:   1%|          | 30/3960 [00:05<12:24,  5.28it/s]Computing perplexity:   1%|          | 31/3960 [00:05<12:25,  5.27it/s]Computing perplexity:   1%|          | 32/3960 [00:06<12:22,  5.29it/s]Computing perplexity:   1%|          | 33/3960 [00:06<12:25,  5.26it/s]Computing perplexity:   1%|          | 34/3960 [00:06<12:23,  5.28it/s]Computing perplexity:   1%|          | 35/3960 [00:06<12:26,  5.26it/s]Computing perplexity:   1%|          | 36/3960 [00:06<12:23,  5.28it/s]Computing perplexity:   1%|          | 37/3960 [00:07<12:25,  5.26it/s]Computing perplexity:   1%|          | 38/3960 [00:07<12:23,  5.28it/s]Computing perplexity:   1%|          | 39/3960 [00:07<12:26,  5.25it/s]Computing perplexity:   1%|          | 40/3960 [00:07<12:23,  5.27it/s]Computing perplexity:   1%|          | 41/3960 [00:07<12:25,  5.26it/s]Computing perplexity:   1%|          | 42/3960 [00:07<12:24,  5.26it/s]Computing perplexity:   1%|          | 43/3960 [00:08<12:25,  5.26it/s]Computing perplexity:   1%|          | 44/3960 [00:08<12:22,  5.27it/s]Computing perplexity:   1%|          | 45/3960 [00:08<12:24,  5.26it/s]Computing perplexity:   1%|          | 46/3960 [00:08<12:21,  5.28it/s]Computing perplexity:   1%|          | 47/3960 [00:08<12:24,  5.26it/s]Computing perplexity:   1%|          | 48/3960 [00:09<12:21,  5.28it/s]Computing perplexity:   1%|          | 49/3960 [00:09<12:24,  5.26it/s]Computing perplexity:   1%|▏         | 50/3960 [00:09<12:21,  5.27it/s]Computing perplexity:   1%|▏         | 51/3960 [00:09<12:22,  5.26it/s]Computing perplexity:   1%|▏         | 52/3960 [00:09<12:20,  5.28it/s]Computing perplexity:   1%|▏         | 53/3960 [00:10<12:23,  5.26it/s]Computing perplexity:   1%|▏         | 54/3960 [00:10<12:20,  5.27it/s]Computing perplexity:   1%|▏         | 55/3960 [00:10<12:23,  5.25it/s]Computing perplexity:   1%|▏         | 56/3960 [00:10<12:20,  5.27it/s]Computing perplexity:   1%|▏         | 57/3960 [00:10<12:22,  5.25it/s]Computing perplexity:   1%|▏         | 58/3960 [00:11<12:20,  5.27it/s]Computing perplexity:   1%|▏         | 59/3960 [00:11<12:21,  5.26it/s]Computing perplexity:   2%|▏         | 60/3960 [00:11<12:18,  5.28it/s]Computing perplexity:   2%|▏         | 61/3960 [00:11<12:21,  5.26it/s]Computing perplexity:   2%|▏         | 62/3960 [00:11<12:17,  5.28it/s]Computing perplexity:   2%|▏         | 63/3960 [00:11<12:19,  5.27it/s]Computing perplexity:   2%|▏         | 64/3960 [00:12<12:17,  5.28it/s]Computing perplexity:   2%|▏         | 65/3960 [00:12<12:18,  5.27it/s]Computing perplexity:   2%|▏         | 66/3960 [00:12<12:16,  5.29it/s]Computing perplexity:   2%|▏         | 67/3960 [00:12<12:17,  5.28it/s]Computing perplexity:   2%|▏         | 68/3960 [00:12<12:17,  5.28it/s]Computing perplexity:   2%|▏         | 69/3960 [00:13<12:18,  5.27it/s]Computing perplexity:   2%|▏         | 70/3960 [00:13<12:17,  5.27it/s]Computing perplexity:   2%|▏         | 71/3960 [00:13<12:17,  5.27it/s]Computing perplexity:   2%|▏         | 72/3960 [00:13<12:16,  5.28it/s]Computing perplexity:   2%|▏         | 73/3960 [00:13<12:16,  5.28it/s]Computing perplexity:   2%|▏         | 74/3960 [00:14<12:16,  5.27it/s]Computing perplexity:   2%|▏         | 75/3960 [00:14<12:15,  5.28it/s]Computing perplexity:   2%|▏         | 76/3960 [00:14<12:16,  5.28it/s]Computing perplexity:   2%|▏         | 77/3960 [00:14<12:14,  5.29it/s]Computing perplexity:   2%|▏         | 78/3960 [00:14<12:15,  5.27it/s]Computing perplexity:   2%|▏         | 79/3960 [00:14<12:14,  5.28it/s]Computing perplexity:   2%|▏         | 80/3960 [00:15<12:17,  5.26it/s]Computing perplexity:   2%|▏         | 81/3960 [00:15<12:14,  5.28it/s]Computing perplexity:   2%|▏         | 82/3960 [00:15<12:16,  5.27it/s]Computing perplexity:   2%|▏         | 83/3960 [00:15<12:15,  5.27it/s]Computing perplexity:   2%|▏         | 84/3960 [00:15<12:16,  5.26it/s]Computing perplexity:   2%|▏         | 85/3960 [00:16<12:13,  5.28it/s]Computing perplexity:   2%|▏         | 86/3960 [00:16<12:16,  5.26it/s]Computing perplexity:   2%|▏         | 87/3960 [00:16<12:14,  5.27it/s]Computing perplexity:   2%|▏         | 88/3960 [00:16<12:15,  5.26it/s]Computing perplexity:   2%|▏         | 89/3960 [00:16<12:12,  5.28it/s]Computing perplexity:   2%|▏         | 90/3960 [00:17<12:15,  5.26it/s]Computing perplexity:   2%|▏         | 91/3960 [00:17<12:13,  5.28it/s]Computing perplexity:   2%|▏         | 92/3960 [00:17<12:15,  5.26it/s]Computing perplexity:   2%|▏         | 93/3960 [00:17<12:14,  5.27it/s]Computing perplexity:   2%|▏         | 94/3960 [00:17<12:15,  5.26it/s]Computing perplexity:   2%|▏         | 95/3960 [00:18<12:13,  5.27it/s]Computing perplexity:   2%|▏         | 96/3960 [00:18<12:14,  5.26it/s]Computing perplexity:   2%|▏         | 97/3960 [00:18<12:13,  5.27it/s]Computing perplexity:   2%|▏         | 98/3960 [00:18<12:14,  5.26it/s]Computing perplexity:   2%|▎         | 99/3960 [00:18<12:12,  5.27it/s]                                                                         Computing MIA resistance...
    Forget Efficacy: 100.00%
    Retain Performance: 0.00%
    MIA Resistance: 51.43%
Saved JSON results to outputs/benchmark_results.json
Saved LaTeX table to outputs/results_table.tex

============================================================
FINAL RESULTS - LaTeX Table
============================================================

\begin{table}[t!]
    \centering
    \begin{threeparttable}
        \caption{Baseline unlearning performance on the TOFU benchmark.}
        \label{tab:baseline-results}
        \begin{tabular}{@{}lcccc@{}}
            \toprule
            \textbf{Method} & \textbf{\makecell{Forget \\ Efficacy ($\uparrow$)}} & \textbf{\makecell{Retain \\ Performance ($\uparrow$)}} & \textbf{\makecell{MIA \\ Resistance ($\uparrow$)}} & \textbf{\makecell{Comp. \\ Cost ($\downarrow$)}} \\
            \midrule
            Retraining (Gold Standard) & 100.00\% & 86.00\% & 50.00\% & 100.0\% \\
            Naive Fine-tuning (FT) & 0.00\% & 100.00\% & 64.29\% & 0.1\% \\
            Gradient Ascent (GA) & 100.00\% & 0.00\% & 100.00\% & 0.0\% \\
            Dual Signed Adaptation (DSU) & 0.00\% & 100.00\% & 65.71\% & 0.1\% \\
            Trust-Region Orthogonal (TROU) & 100.00\% & 0.00\% & 51.43\% & 0.1\% \\
            \bottomrule
        \end{tabular}
        \begin{tablenotes}[para,flushleft]
            \small
            \textit{Note:} \textbf{Forget Efficacy} measures success at forgetting; \textbf{Retain Performance} measures accuracy on retain data; \textbf{MIA Resistance} measures attack failure rate; \textbf{Comp. Cost} is relative to retraining. Higher is better for all metrics except Comp. Cost.
        \end{tablenotes}
    \end{threeparttable}
\end{table}

